{"version":3,"sources":["webpack:///./node_modules/@duet3d/motionanalysis/dist/analysis.js","webpack:///./node_modules/@duet3d/motionanalysis/dist/fft.js","webpack:///./node_modules/@duet3d/motionanalysis/dist/index.js","webpack:///./node_modules/@duet3d/motionanalysis/dist/shapers.js","webpack:///src/plugins/InputShaping/InputShaperCheckbox.vue","webpack:///src/plugins/InputShaping/InputShaping.vue","webpack:///src/plugins/InputShaping/InputShapingChart.vue","webpack:///src/plugins/InputShaping/InputShapingFileList.vue","webpack:///src/plugins/InputShaping/RecordMotionProfileDialog.vue","webpack:///./src/plugins/InputShaping/InputShaperCheckbox.vue?76ef","webpack:///./src/plugins/InputShaping/InputShaping.vue?4722","webpack:///./src/plugins/InputShaping/InputShapingChart.vue?d843","webpack:///./src/plugins/InputShaping/InputShapingFileList.vue?d713","webpack:///./src/plugins/InputShaping/RecordMotionProfileDialog.vue?e920","webpack:///./src/plugins/InputShaping/InputShaperCheckbox.vue","webpack:///./src/plugins/InputShaping/InputShaperCheckbox.vue?bd63","webpack:///./src/plugins/InputShaping/InputShaperCheckbox.vue?2a22","webpack:///./src/plugins/InputShaping/InputShaping.vue?679e","webpack:///./src/plugins/InputShaping/InputShaping.vue?5fa2","webpack:///./src/plugins/InputShaping/InputShaping.vue?458e","webpack:///./src/plugins/InputShaping/InputShaping.vue?2d58","webpack:///./src/plugins/InputShaping/InputShapingChart.vue","webpack:///./src/plugins/InputShaping/InputShapingChart.vue?458e","webpack:///./src/plugins/InputShaping/InputShapingChart.vue?08b4","webpack:///./src/plugins/InputShaping/InputShapingFileList.vue?71a1","webpack:///./src/plugins/InputShaping/InputShapingFileList.vue?ec35","webpack:///./src/plugins/InputShaping/InputShapingFileList.vue?5fd8","webpack:///./src/plugins/InputShaping/InputShapingFileList.vue?6599","webpack:///./src/plugins/InputShaping/RangePlugin.js","webpack:///./src/plugins/InputShaping/RecordMotionProfileDialog.vue?c17b","webpack:///./src/plugins/InputShaping/RecordMotionProfileDialog.vue?d1be","webpack:///./src/plugins/InputShaping/RecordMotionProfileDialog.vue?0433","webpack:///./src/plugins/InputShaping/RecordMotionProfileDialog.vue?17b2","webpack:///./src/plugins/InputShaping/VLinePlugin.js","webpack:///./src/plugins/InputShaping/index.js","webpack:///./src/utils/csv.js"],"names":["Object","defineProperty","exports","value","analyzeAccelerometerData","fft_1","samples","samplingRate","wideBand","length","Error","numSamples","freqResolution","numFreqs","Math","floor","min","result","frequencies","Array","amplitudes","i","axis","real","slice","imag","fill","transform","k","sqrt","n","RangeError","transformRadix2","transformBluestein","inverseTransform","levels","cosTable","sinTable","cos","PI","sin","j","reverseBits","temp","size","halfsize","tablestep","l","tpre","tpim","val","width","m","areal","newArrayOfZeros","aimag","breal","bimag","creal","cimag","convolveComplex","convolveReal","xvec","yvec","outvec","xreal","ximag","yreal","yimag","outreal","outimag","push","__createBinding","this","create","o","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","__exportStar","p","prototype","hasOwnProperty","call","InputShaperType","getInputShaperFactors","type","frequency","dampingFactor","durations","sqrtOneMinusZetaSquared","pow","dampedFrequency","dampedPeriod","exp","mzv","kMzv","a1","a2","a3","sum","zvd","zvdd","zvddd","ei2","zetaSquared","zetaCubed","ei3","getInputShaperDamping","stepSizes","accTimes","duration","totalSine","totalCosine","props","inputValue","required","current","canApply","default","model","prop","event","computed","mapGetters","mapState","shapingFrequency","shapingType","label","showApply","methods","mapActions","change","e","apply","components","RecordMotionProfileDialog","InputShaperCheckbox","InputShapingChart","InputShapingFileList","shaping","isInputShapingEnabled","currentFrequencies","lastRun","numCustomCoefficients","set","canConfigureCustom","customShaperCode","canSetFrequency","canSetDamping","data","tab","showDataCollection","inputShapers","customAmplitudes","customDurations","customMenu","configuringCustomShaper","damping","files","loadingFiles","filesError","filesToAnalyze","fileFrequenciesToAnalyze","fileDataToAnalyze","showOriginalValues","estimateShaperEffect","sampleStartIndex","sampleEndIndex","hadOverflow","recordingFinished","setCustomAmplitude","index","Vue","setCustomDuration","copy","document","configureCustomShaper","setFrequency","setDamping","refresh","filter","filesOrDirectoriesChanged","mounted","beforeDestroy","watch","to","deep","handler","selectedMachine","ringingFrequency","showValues","inputShaperFrequency","inputShaperDamping","showReduction","resolution","lineAtPoint","point","delta","chart","options","dragStart","isUpdating","animation","hover","mode","intersect","legend","labels","onClick","legendItem","meta","ci","maintainAspectRatio","plugins","range","vline","lineColor","lineWidth","scales","xAxes","display","gridLines","scaleLabel","labelString","ticks","minor","fontFamily","major","beginAtZero","maxTicksLimit","yAxes","id","position","max","tooltips","enabled","callbacks","tooltipItem","title","that","datasets","applyDarkTheme","active","getLineColor","updateDatasets","borderColor","backgroundColor","pointBorderWidth","pointRadius","borderWidth","isShaperFrequency","shaperType","console","borderDash","yAxisID","isCustom","maxFrequencyIndex","dataset","update","mouseDown","start","mouseMove","mouseUp","mouseLeave","doubleClick","arraysDiffer","a","b","from","darkTheme","language","canDelete","canShowSamples","selectedFiles","profiles","run","icon","subtitle","filename","shaperTitle","uncategorized","shaperTitles","allEqual","profile","selection","progress","progressMax","estimateEffect","individualFiles","showSamples","deleteProfile","file","deleteFile","setShowSamples","getSamples","showProgress","showSuccess","showError","csvFile","csv","details","parseFloat","overflows","sampleValues","getFrequencyResponse","sampleResult","X","Y","Z","axisSamples","frequencyResponse","idle","recording","finished","cancelled","shown","xAxis","yAxis","zAxis","shownInternal","shaper","allAxesHomed","accelerometers","map","text","hasExternalAccelerometers","toolList","showZCenter","maxSpeed","canGoBack","canGoNext","move","currentPage","moves","centerAxes","xAxisCenter","yAxisCenter","zAxisCenter","recordWholeMove","refreshCenters","makeMoves","state","tool","accelerometer","end","addMove","setMoveTool","setMoveAxis","removeMove","getMin","getMax","getRules","getAccelerometerId","doCode","code","reply","getMoveFilename","accelerometerId","waitForAccelerometerRun","promise","resolve","reject","unwatch","recordMove","moveIndex","hadSelectedTool","moveAxes","startMoveParameters","endMoveParameters","getMoveIcon","cancel","goBack","goNext","render","_vm","_h","$createElement","_c","_self","attrs","uiFrozen","on","scopedSlots","_u","key","fn","_t","directives","name","rawName","expression","_v","proxy","staticRenderFns","callback","$$v","staticClass","$event","_s","class","indexOf","_k","keyCode","preventDefault","arguments","_n","ref","$emit","_l","fileIndex","stopPropagation","_e","item","$set","isNaN","component","VCheckbox","VChip","VAlert","VBtn","VCard","VCardText","VCardTitle","VCol","VDivider","VIcon","VProgressLinear","VRow","VTab","VTabItem","VTabs","VTabsItems","VTextField","VList","VListGroup","VListItem","VListItemContent","VListItemGroup","VListItemIcon","VListItemSubtitle","VListItemTitle","VSpacer","Ripple","verticalLinePlugin","renderRect","chartInstance","startX","endX","scale","context","ctx","beginPath","rect","top","bottom","fillStyle","color","beforeDatasetsDraw","config","Chart","register","VCardActions","VDialog","VSelect","VSimpleTable","VWindow","VWindowItem","VLinePlugin","getLinePosition","pointIndex","getDatasetMeta","_model","x","renderVerticalLine","lineLeftOffset","strokeStyle","moveTo","lineTo","stroke","lineAtIndex","forEach","registerRoute","InputShaping","Plugins","caption","translated","path","CSV","content","row","col","inQuote","char","nextChar","headers","splice","fieldName","findIndex","header"],"mappings":"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A,sDACA,oDAGA,uFAEAC,cA7LA,yBA+LA,wFAEAC,OACA,eADA,qBACAC,GACA,WACA,sBAEA,+BACA,0BAGA,eACA,sDACA,uDAIA,sBACAC,QACAC,QAFA,iBAEAF,GACA,qEACA,mCAIA,qBACAC,QACAC,QAFA,iBAEAF,GACA,qEACA,kCAIA,oBA/BA,0BA+BAA,GACA,kBAEA,kBAlCA,wBAkCAA,GACA,gBAEA1C,sBArCA,iCAqCA,WACA,2BACA,oBACA,0CAIA6C,gBA5CA,2BA6CA,mB,86CClbe,cACf3E,OACAtG,kBACAkL,wBACAjM,aACAkM,YACAxE,WACAjC,cAEAiF,wBACAC,sBAEAf,mBACAuC,4BACAC,0BAEAvC,uBACAC,sBAEAW,8BAEA3C,sDACAE,iDADA,IAEAqE,cAFA,yBAEA,sHACAC,WAHA,sBAGA,8FACAC,YAJA,uBAKA,SACA,uEAEA,IADA,MACA,mCACA,4DACA,cACAC,IACAC,KAIA,oBAEAD,MAGA,YAGA/C,KA7CA,gBA8CA,OACAiD,WACAC,WACAC,eACAC,gBAGAnB,QArDA,mBAuDA,WACA,cACAoB,aACAC,OACAC,eACAC,cAEAC,QACAC,UACAC,QAFA,iBAEA5E,EAAA6E,GACA,qBACA,aACA,sBAGAC,yDAGA,uCACAC,kDAIAA,aAGAC,uBACAC,SACAC,SACAC,OACAC,oBACAC,cAGAC,QACAC,OACA,CACAC,WACAC,WACAD,YAEAE,YACAF,WACAG,sFAEAC,OACAC,OACAC,gCAEAC,OACAD,gCAEAE,eACAC,oBAIAC,OACA,CACAV,qBACAC,WACAD,YAEAE,YACAF,WACAG,2FAEAC,OACAC,OACAC,gCAEAC,OACAD,kCAIA,CACAN,2BACAC,WACAD,YAEAW,aACAC,mCACAV,YACAF,WACAG,gCAEAC,OACAvN,MACAgO,UAKAC,UACAC,WACAC,WACA7G,MADA,eACA8G,EAAAxF,GACA,+CAKA,OAJA,QACAtB,aAEAA,wFACA,OAEA+G,wBAAA,qBACAC,kHACAA,+DAMA,sCACAxC,qBACAlD,MACA2F,YACAjC,aAGA,sBACA,qCAEA9E,SACAgH,eADA,wBACAC,GACA,sBACA,oDACA,kEACA,kEACA,iEACA,kEACA,kEACA,iEACA,kEACA,kEACA,iEAEA,oDACA,4DACA,4DACA,oEACA,4DACA,oEAEA,qBAEAC,aAvBA,sBAuBAxE,GACA,OACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEA,sBAEAyE,eArCA,0BAqCA,WACA,0HACA,0BACA,4BAGA,QACA,yBACA,oBACA,OACAC,+DACAC,mEACAC,qBACAC,cACAC,iBACApG,mBACAlI,QACA4G,SAEA,iCAGA,yBACA3H,wBAUA,GALA,sDACA,sDACA,oJAAAF,WAAA,2BAGA,yDACA,iDAEA,OACAmP,sBACAC,0BACAjG,QACAtB,yBACA2H,sBAEA,sCAEA,iCAIA,wGACA,mBADA,+BACAC,EADA,QAEA,4BACA,iBACA,gCAEA,OADAC,mDACA,WAGA,wFACA,6EAEA,0BACA,sBACA,OACAP,yDACAC,6DACAC,qBACAC,cACAK,qCACAJ,iBACApG,mCAAA,iBACAlI,QACA4G,kDAEA,kCAEA,CACA,OACAsH,yDACAC,6DACAC,mBACAC,cACAK,iBACAJ,iBACApG,OACAlI,QACA4G,sBACA+H,mBAEA,gCAvCA,+BADA,+BAkFA,GApCA,0MACA,6FACA,0BACA,sBACA,OACAT,yDACAC,6DACAC,mBACAC,cACAK,qCACAJ,iBACApG,mCAAA,iBACAlI,QACA4G,gCAEA,kCAEA,CACA,OACAsH,yDACAC,6DACAC,mBACAC,cACAK,kBACAJ,iBACApG,OACAlI,QACA4G,eACA+H,kBACAC,aAEA,+BA/BA,IAoCA,oIACA,iDAEA,OACAV,sBACAC,0BACAjG,QACAtB,yBACA2H,sBAEA,iCAIA,gDACA,IADA,EACA,KADA,uBAEA,kBAFA,IAEA,0CACA,qBACA,MAEAM,KANA,8BASA,qCACA,0BADA,IACA,0CACA,wBACAC,oBAHA,8BAMA,mCACA,uDAKA,mIACA,wIACA,wDACA,8DACA,sEA1KA,6BA2KA,0BA3KA,IA2KA,0CACA,sBACAA,cA7KA,gCAiLAC,OAtNA,kBAsNA,WACA,kBACA,mBACA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","file":"js/InputShaping.b89c7975.js","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.analyzeAccelerometerData = void 0;\r\nconst fft_1 = require(\"./fft\");\r\n/**\r\n * Analyze the given accelerometer data by computing the ringing frequencies from the samples at a given sampling rate.\r\n * This effectively performs an FFT on the given data set\r\n * @param samples Accelerometer samples of each axis\r\n * @param samplingRate Sampling rate in Hz\r\n * @param wideBand Perform wide-band analysis (more frequencies)\r\n * @returns Frequency vs. amplitude per axis\r\n */\r\nfunction analyzeAccelerometerData(samples, samplingRate, wideBand = false) {\r\n    if (samples.length < 1) {\r\n        throw new Error(\"Too few samples to perform frequency analysis\");\r\n    }\r\n    // Determine number of axes, frequency resolution, and number of frequencies to compute\r\n    const numSamples = samples[0].length, freqResolution = samplingRate / numSamples;\r\n    const numFreqs = Math.floor(Math.min(numSamples / 2, (wideBand ? (samplingRate / 2) : 200) / freqResolution));\r\n    // Prepare result\r\n    const result = {\r\n        frequencies: new Array(numFreqs),\r\n        amplitudes: new Array(samples.length)\r\n    };\r\n    for (let i = 0; i < numFreqs; i++) {\r\n        result.frequencies[i] = i * freqResolution + freqResolution / 2;\r\n    }\r\n    for (let axis = 0; axis < samples.length; axis++) {\r\n        // Perform FFT on the samples per axis\r\n        const real = samples[axis].slice(), imag = new Array(numSamples);\r\n        imag.fill(0);\r\n        (0, fft_1.transform)(real, imag);\r\n        // Compute amplitudes\r\n        const amplitudes = new Array(numFreqs);\r\n        for (let k = 1; k <= numFreqs; k++) {\r\n            amplitudes[k - 1] = Math.sqrt(real[k] * real[k] + imag[k] * imag[k]) / numSamples;\r\n        }\r\n        result.amplitudes[axis] = amplitudes;\r\n    }\r\n    return result;\r\n}\r\nexports.analyzeAccelerometerData = analyzeAccelerometerData;\r\n","\"use strict\";\r\n/*\r\n * Free FFT and convolution (TypeScript)\r\n *\r\n * Copyright (c) 2022 Project Nayuki. (MIT License)\r\n * https://www.nayuki.io/page/free-small-fft-in-multiple-languages\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n * - The above copyright notice and this permission notice shall be included in\r\n *   all copies or substantial portions of the Software.\r\n * - The Software is provided \"as is\", without warranty of any kind, express or\r\n *   implied, including but not limited to the warranties of merchantability,\r\n *   fitness for a particular purpose and noninfringement. In no event shall the\r\n *   authors or copyright holders be liable for any claim, damages or other\r\n *   liability, whether in an action of contract, tort or otherwise, arising from,\r\n *   out of or in connection with the Software or the use or other dealings in the\r\n *   Software.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.newArrayOfZeros = exports.convolveComplex = exports.convolveReal = exports.transformBluestein = exports.transformRadix2 = exports.inverseTransform = exports.transform = void 0;\r\n/*\r\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\r\n * The vector can have any length. This is a wrapper function.\r\n */\r\nfunction transform(real, imag) {\r\n    const n = real.length;\r\n    if (n != imag.length)\r\n        throw new RangeError(\"Mismatched lengths\");\r\n    if (n == 0)\r\n        return;\r\n    else if ((n & (n - 1)) == 0) // Is power of 2\r\n        transformRadix2(real, imag);\r\n    else // More complicated algorithm for arbitrary sizes\r\n        transformBluestein(real, imag);\r\n}\r\nexports.transform = transform;\r\n/*\r\n * Computes the inverse discrete Fourier transform (IDFT) of the given complex vector, storing the result back into the vector.\r\n * The vector can have any length. This is a wrapper function. This transform does not perform scaling, so the inverse is not a true inverse.\r\n */\r\nfunction inverseTransform(real, imag) {\r\n    transform(imag, real);\r\n}\r\nexports.inverseTransform = inverseTransform;\r\n/*\r\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\r\n * The vector's length must be a power of 2. Uses the Cooley-Tukey decimation-in-time radix-2 algorithm.\r\n */\r\nfunction transformRadix2(real, imag) {\r\n    // Length variables\r\n    const n = real.length;\r\n    if (n != imag.length)\r\n        throw new RangeError(\"Mismatched lengths\");\r\n    if (n == 1) // Trivial transform\r\n        return;\r\n    let levels = -1;\r\n    for (let i = 0; i < 32; i++) {\r\n        if (1 << i == n)\r\n            levels = i; // Equal to log2(n)\r\n    }\r\n    if (levels == -1)\r\n        throw new RangeError(\"Length is not a power of 2\");\r\n    // Trigonometric tables\r\n    let cosTable = new Array(n / 2);\r\n    let sinTable = new Array(n / 2);\r\n    for (let i = 0; i < n / 2; i++) {\r\n        cosTable[i] = Math.cos(2 * Math.PI * i / n);\r\n        sinTable[i] = Math.sin(2 * Math.PI * i / n);\r\n    }\r\n    // Bit-reversed addressing permutation\r\n    for (let i = 0; i < n; i++) {\r\n        const j = reverseBits(i, levels);\r\n        if (j > i) {\r\n            let temp = real[i];\r\n            real[i] = real[j];\r\n            real[j] = temp;\r\n            temp = imag[i];\r\n            imag[i] = imag[j];\r\n            imag[j] = temp;\r\n        }\r\n    }\r\n    // Cooley-Tukey decimation-in-time radix-2 FFT\r\n    for (let size = 2; size <= n; size *= 2) {\r\n        const halfsize = size / 2;\r\n        const tablestep = n / size;\r\n        for (let i = 0; i < n; i += size) {\r\n            for (let j = i, k = 0; j < i + halfsize; j++, k += tablestep) {\r\n                const l = j + halfsize;\r\n                const tpre = real[l] * cosTable[k] + imag[l] * sinTable[k];\r\n                const tpim = -real[l] * sinTable[k] + imag[l] * cosTable[k];\r\n                real[l] = real[j] - tpre;\r\n                imag[l] = imag[j] - tpim;\r\n                real[j] += tpre;\r\n                imag[j] += tpim;\r\n            }\r\n        }\r\n    }\r\n    // Returns the integer whose value is the reverse of the lowest 'width' bits of the integer 'val'.\r\n    function reverseBits(val, width) {\r\n        let result = 0;\r\n        for (let i = 0; i < width; i++) {\r\n            result = (result << 1) | (val & 1);\r\n            val >>>= 1;\r\n        }\r\n        return result;\r\n    }\r\n}\r\nexports.transformRadix2 = transformRadix2;\r\n/*\r\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\r\n * The vector can have any length. This requires the convolution function, which in turn requires the radix-2 FFT function.\r\n * Uses Bluestein's chirp z-transform algorithm.\r\n */\r\nfunction transformBluestein(real, imag) {\r\n    // Find a power-of-2 convolution length m such that m >= n * 2 + 1\r\n    const n = real.length;\r\n    if (n != imag.length)\r\n        throw new RangeError(\"Mismatched lengths\");\r\n    let m = 1;\r\n    while (m < n * 2 + 1)\r\n        m *= 2;\r\n    // Trigonometric tables\r\n    let cosTable = new Array(n);\r\n    let sinTable = new Array(n);\r\n    for (let i = 0; i < n; i++) {\r\n        const j = i * i % (n * 2); // This is more accurate than j = i * i\r\n        cosTable[i] = Math.cos(Math.PI * j / n);\r\n        sinTable[i] = Math.sin(Math.PI * j / n);\r\n    }\r\n    // Temporary vectors and preprocessing\r\n    let areal = newArrayOfZeros(m);\r\n    let aimag = newArrayOfZeros(m);\r\n    for (let i = 0; i < n; i++) {\r\n        areal[i] = real[i] * cosTable[i] + imag[i] * sinTable[i];\r\n        aimag[i] = -real[i] * sinTable[i] + imag[i] * cosTable[i];\r\n    }\r\n    let breal = newArrayOfZeros(m);\r\n    let bimag = newArrayOfZeros(m);\r\n    breal[0] = cosTable[0];\r\n    bimag[0] = sinTable[0];\r\n    for (let i = 1; i < n; i++) {\r\n        breal[i] = breal[m - i] = cosTable[i];\r\n        bimag[i] = bimag[m - i] = sinTable[i];\r\n    }\r\n    // Convolution\r\n    let creal = new Array(m);\r\n    let cimag = new Array(m);\r\n    convolveComplex(areal, aimag, breal, bimag, creal, cimag);\r\n    // Postprocessing\r\n    for (let i = 0; i < n; i++) {\r\n        real[i] = creal[i] * cosTable[i] + cimag[i] * sinTable[i];\r\n        imag[i] = -creal[i] * sinTable[i] + cimag[i] * cosTable[i];\r\n    }\r\n}\r\nexports.transformBluestein = transformBluestein;\r\n/*\r\n * Computes the circular convolution of the given real vectors. Each vector's length must be the same.\r\n */\r\nfunction convolveReal(xvec, yvec, outvec) {\r\n    const n = xvec.length;\r\n    if (n != yvec.length || n != outvec.length)\r\n        throw new RangeError(\"Mismatched lengths\");\r\n    convolveComplex(xvec, newArrayOfZeros(n), yvec, newArrayOfZeros(n), outvec, newArrayOfZeros(n));\r\n}\r\nexports.convolveReal = convolveReal;\r\n/*\r\n * Computes the circular convolution of the given complex vectors. Each vector's length must be the same.\r\n */\r\nfunction convolveComplex(xreal, ximag, yreal, yimag, outreal, outimag) {\r\n    const n = xreal.length;\r\n    if (n != ximag.length || n != yreal.length || n != yimag.length\r\n        || n != outreal.length || n != outimag.length)\r\n        throw new RangeError(\"Mismatched lengths\");\r\n    xreal = xreal.slice();\r\n    ximag = ximag.slice();\r\n    yreal = yreal.slice();\r\n    yimag = yimag.slice();\r\n    transform(xreal, ximag);\r\n    transform(yreal, yimag);\r\n    for (let i = 0; i < n; i++) {\r\n        const temp = xreal[i] * yreal[i] - ximag[i] * yimag[i];\r\n        ximag[i] = ximag[i] * yreal[i] + xreal[i] * yimag[i];\r\n        xreal[i] = temp;\r\n    }\r\n    inverseTransform(xreal, ximag);\r\n    for (let i = 0; i < n; i++) { // Scaling (because this FFT implementation omits it)\r\n        outreal[i] = xreal[i] / n;\r\n        outimag[i] = ximag[i] / n;\r\n    }\r\n}\r\nexports.convolveComplex = convolveComplex;\r\nfunction newArrayOfZeros(n) {\r\n    let result = [];\r\n    for (let i = 0; i < n; i++)\r\n        result.push(0);\r\n    return result;\r\n}\r\nexports.newArrayOfZeros = newArrayOfZeros;\r\n","\"use strict\";\r\n// This library is intended to analyze accelerometer datasets and to compute input shaping estimations\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// Export functionality for data analysis\r\n__exportStar(require(\"./analysis\"), exports);\r\n// Export functionality for input shaper computations\r\n__exportStar(require(\"./shapers\"), exports);\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getInputShaperDamping = exports.getInputShaperFactors = exports.InputShaperType = void 0;\r\n/**\r\n * Supported input shaper types\r\n * TODO: Replace this with enum from @duet3d/objectmodel\r\n */\r\nvar InputShaperType;\r\n(function (InputShaperType) {\r\n    InputShaperType[\"ei2\"] = \"ei2\";\r\n    InputShaperType[\"ei3\"] = \"ei3\";\r\n    InputShaperType[\"mzv\"] = \"mzv\";\r\n    InputShaperType[\"zvd\"] = \"zvd\";\r\n    InputShaperType[\"zvdd\"] = \"zvdd\";\r\n    InputShaperType[\"zvddd\"] = \"zvddd\";\r\n})(InputShaperType = exports.InputShaperType || (exports.InputShaperType = {}));\r\n/***\r\n * Compute input shaper amplitudes and durations like RepRapFirmware does\r\n * @param type Input shaper type\r\n * @param frequency Target frequency (in Hz)\r\n * @param dampingFactor Optional damping factor (zeta)\r\n * @returns Input shaper factors\r\n */\r\nfunction getInputShaperFactors(type, frequency, dampingFactor = 0.1) {\r\n    const result = {\r\n        amplitudes: [],\r\n        durations: []\r\n    };\r\n    const sqrtOneMinusZetaSquared = Math.sqrt(1 - Math.pow(dampingFactor, 2));\r\n    const dampedFrequency = frequency * sqrtOneMinusZetaSquared;\r\n    const dampedPeriod = 1 / dampedFrequency;\r\n    const k = Math.exp(-dampingFactor * Math.PI / sqrtOneMinusZetaSquared);\r\n    switch (type) {\r\n        case InputShaperType.mzv:\r\n            {\r\n                // Klipper gives amplitude steps of [a3 = k^2 * (1 - 1/sqrt(2)), a2 = k * (sqrt(2) - 1), a1 = 1 - 1/sqrt(2)] all divided by (a1 + a2 + a3)\r\n                // Rearrange to: a3 = k^2 * (1 - sqrt(2)/2), a2 = k * (sqrt(2) - 1), a1 = (1 - sqrt(2)/2)\r\n                const kMzv = Math.exp(-dampingFactor * 0.75 * Math.PI / sqrtOneMinusZetaSquared);\r\n                const a1 = 1.0 - 0.5 * Math.sqrt(2);\r\n                const a2 = (Math.sqrt(2) - 1) * kMzv;\r\n                const a3 = a1 * kMzv * kMzv;\r\n                const sum = (a1 + a2 + a3);\r\n                result.amplitudes.push(a3 / sum);\r\n                result.amplitudes.push((a2 + a3) / sum);\r\n            }\r\n            result.durations.push(0.375 * dampedPeriod);\r\n            result.durations.push(0.375 * dampedPeriod);\r\n            break;\r\n        case InputShaperType.zvd:\r\n            {\r\n                const j = Math.pow(1 + k, 2);\r\n                result.amplitudes.push(1 / j);\r\n                result.amplitudes.push(1 / j + 2 * k / j);\r\n            }\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            break;\r\n        case InputShaperType.zvdd:\r\n            {\r\n                const j = Math.pow(1 + k, 3);\r\n                result.amplitudes.push(1 / j);\r\n                result.amplitudes.push(result.amplitudes[0] + 3 * k / j);\r\n                result.amplitudes.push(result.amplitudes[1] + 3 * Math.pow(k, 2) / j);\r\n            }\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            break;\r\n        case InputShaperType.zvddd:\r\n            {\r\n                const j = Math.pow(1 + k, 4);\r\n                result.amplitudes.push(1 / j);\r\n                result.amplitudes.push(result.amplitudes[0] + 4 * k / j);\r\n                result.amplitudes.push(result.amplitudes[1] + 6 * Math.pow(k, 2) / j);\r\n                result.amplitudes.push(result.amplitudes[2] + 4 * Math.pow(k, 3) / j);\r\n            }\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            result.durations.push(0.5 * dampedPeriod);\r\n            break;\r\n        case InputShaperType.ei2: // see http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.465.1337&rep=rep1&type=pdf. United States patent #4,916,635.\r\n            {\r\n                const zetaSquared = Math.pow(dampingFactor, 2), zetaCubed = zetaSquared * dampingFactor;\r\n                result.amplitudes.push((0.16054) + (0.76699) * dampingFactor + (2.26560) * zetaSquared + (-1.22750) * zetaCubed);\r\n                result.amplitudes.push((0.16054 + 0.33911) + (0.76699 + 0.45081) * dampingFactor + (2.26560 - 2.58080) * zetaSquared + (-1.22750 + 1.73650) * zetaCubed);\r\n                result.amplitudes.push((0.16054 + 0.33911 + 0.34089) + (0.76699 + 0.45081 - 0.61533) * dampingFactor + (2.26560 - 2.58080 - 0.68765) * zetaSquared + (-1.22750 + 1.73650 + 0.42261) * zetaCubed);\r\n                result.durations.push(((0.49890) + (0.16270) * dampingFactor + (-0.54262) * zetaSquared + (6.16180) * zetaCubed) * dampedPeriod);\r\n                result.durations.push(((0.99748 - 0.49890) + (0.18382 - 0.16270) * dampingFactor + (-1.58270 + 0.54262) * zetaSquared + (8.17120 - 6.16180) * zetaCubed) * dampedPeriod);\r\n                result.durations.push(((1.49920 - 0.99748) + (-0.09297 - 0.18382) * dampingFactor + (-0.28338 + 1.58270) * zetaSquared + (1.85710 - 8.17120) * zetaCubed) * dampedPeriod);\r\n            }\r\n            break;\r\n        case InputShaperType.ei3: // see http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.465.1337&rep=rep1&type=pdf. United States patent #4,916,635\r\n            {\r\n                const zetaSquared = Math.pow(dampingFactor, 2);\r\n                const zetaCubed = zetaSquared * dampingFactor;\r\n                result.amplitudes.push((0.11275) + 0.76632 * dampingFactor + (3.29160) * zetaSquared + (-1.44380) * zetaCubed);\r\n                result.amplitudes.push((0.11275 + 0.23698) + (0.76632 + 0.61164) * dampingFactor + (3.29160 - 2.57850) * zetaSquared + (-1.44380 + 4.85220) * zetaCubed);\r\n                result.amplitudes.push((0.11275 + 0.23698 + 0.30008) + (0.76632 + 0.61164 - 0.19062) * dampingFactor + (3.29160 - 2.57850 - 2.14560) * zetaSquared + (-1.44380 + 4.85220 + 0.13744) * zetaCubed);\r\n                result.amplitudes.push((0.11275 + 0.23698 + 0.30008 + 0.23775) + (0.76632 + 0.61164 - 0.19062 - 0.73297) * dampingFactor + (3.29160 - 2.57850 - 2.14560 + 0.46885) * zetaSquared + (-1.44380 + 4.85220 + 0.13744 - 2.08650) * zetaCubed);\r\n                result.durations.push(((0.49974) + (0.23834) * dampingFactor + (0.44559) * zetaSquared + (12.4720) * zetaCubed) * dampedPeriod);\r\n                result.durations.push(((0.99849 - 0.49974) + (0.29808 - 0.23834) * dampingFactor + (-2.36460 - 0.44559) * zetaSquared + (23.3990 - 12.4720) * zetaCubed) * dampedPeriod);\r\n                result.durations.push(((1.49870 - 0.99849) + (0.10306 - 0.29808) * dampingFactor + (-2.01390 + 2.36460) * zetaSquared + (17.0320 - 23.3990) * zetaCubed) * dampedPeriod);\r\n                result.durations.push(((1.99960 - 1.49870) + (-0.28231 - 0.10306) * dampingFactor + (0.61536 + 2.01390) * zetaSquared + (5.40450 - 17.0320) * zetaCubed) * dampedPeriod);\r\n            }\r\n            break;\r\n        default:\r\n            // Other shaper types are not supported\r\n            return result;\r\n    }\r\n    return result;\r\n}\r\nexports.getInputShaperFactors = getInputShaperFactors;\r\n/**\r\n * Compute the damping for the given frequencies with the given input shaper amplitudes and durations\r\n * @param frequencies Frequencies to compute the damping for\r\n * @param amplitudes Input shaper amplitudes (coefficients)\r\n * @param durations Input shaper durations (in s)\r\n * @returns Damping factor (0..1) per frequency\r\n */\r\nfunction getInputShaperDamping(frequencies, amplitudes, durations) {\r\n    // Perform input check\r\n    if (amplitudes.length < 1) {\r\n        throw new Error(\"Insufficient number of amplitudes\");\r\n    }\r\n    if (amplitudes.length !== durations.length) {\r\n        throw new Error(\"Number of amplitudes must match the number of durations\");\r\n    }\r\n    // Compute step sizes\r\n    const stepSizes = [amplitudes[0]];\r\n    for (let i = 1; i < amplitudes.length; i++) {\r\n        stepSizes[i] = amplitudes[i] - amplitudes[i - 1];\r\n    }\r\n    stepSizes.push(1 - amplitudes[amplitudes.length - 1]);\r\n    // Compute the accumulated times in seconds\r\n    const accTimes = [0];\r\n    for (let duration of durations) {\r\n        accTimes.push(duration + accTimes[accTimes.length - 1]);\r\n    }\r\n    // Calculate the actual damping per frequency\r\n    const result = new Array(frequencies.length);\r\n    for (let i = 0; i < frequencies.length; i++) {\r\n        const frequency = frequencies[i];\r\n        let totalSine = 0, totalCosine = 0;\r\n        for (let k = 0; k < stepSizes.length; k++) {\r\n            totalSine += stepSizes[k] * Math.sin(2 * Math.PI * frequency * accTimes[k]);\r\n            totalCosine += stepSizes[k] * Math.cos(2 * Math.PI * frequency * accTimes[k]);\r\n        }\r\n        result[i] = Math.sqrt(totalSine * totalSine + totalCosine * totalCosine);\r\n    }\r\n    return result;\r\n}\r\nexports.getInputShaperDamping = getInputShaperDamping;\r\n","<template>\r\n\t<v-checkbox :input-value=\"(value === 'none') ? (shapingType === 'none') : inputValue\" :value=\"(value === 'none') ? true : value\" :disabled=\"uiFrozen\" :label=\"label\" hide-details @change=\"change\">\r\n\t\t<template #append>\r\n\t\t\t<slot>\r\n\t\t\t\t<v-chip v-show=\"current === value\" small color=\"success\">\r\n\t\t\t\t\tconfigured\r\n\t\t\t\t</v-chip>\r\n\t\t\t\t<v-chip v-show=\"showApply\" small color=\"gray\" @click=\"apply\">\r\n\t\t\t\t\tapply\r\n\t\t\t\t</v-chip>\r\n\t\t\t</slot>\r\n\t\t</template>\r\n\t</v-checkbox>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapActions, mapGetters, mapState } from 'vuex'\r\n\r\nexport default {\r\n\tprops: {\r\n\t\tinputValue: Array,\r\n\t\tvalue: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: String\r\n\t\t},\r\n\t\tcurrent: String,\r\n\t\tcanApply: {\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t}\r\n\t},\r\n\tmodel: {\r\n\t\tprop: 'inputValue',\r\n\t\tevent: 'change'\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['uiFrozen']),\r\n\t\t...mapState('machine/model', {\r\n\t\t\tshapingFrequency: state => state.move.shaping.frequency,\r\n\t\t\tshapingType: state => state.move.shaping.type\r\n\t\t}),\r\n\t\tlabel() {\r\n\t\t\tif (this.value === 'none') {\r\n\t\t\t\treturn 'None';\r\n\t\t\t}\r\n\t\t\tif (this.value === 'custom') {\r\n\t\t\t\treturn 'Custom';\r\n\t\t\t}\r\n\t\t\treturn this.value.toUpperCase();\r\n\t\t},\r\n\t\tshowApply() {\r\n\t\t\treturn this.canApply && !this.uiFrozen && (this.current !== this.value) && (this.shapingFrequency > 0);\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['sendCode']),\r\n\t\tchange(e) {\r\n\t\t\tif (this.value !== 'none') {\r\n\t\t\t\tthis.$emit('change', e);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync apply() {\r\n\t\t\tawait this.sendCode(`M593 P\"${this.value}\"`);\r\n\t\t}\r\n\t}\r\n}\r\n</script>","<style scoped>\r\n.content {\r\n\tposition: relative;\r\n\tmin-height: 480px;\r\n}\r\n\r\n.content canvas {\r\n\tposition: absolute;\r\n}\r\n\r\nth {\r\n\twhite-space: nowrap;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-row>\r\n\t\t<v-col>\r\n\t\t\t<v-card>\r\n\t\t\t\t<v-tabs v-model=\"tab\">\r\n\t\t\t\t\t<!-- Tabs -->\r\n\t\t\t\t\t<v-tab href=\"#current\">\r\n\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-information</v-icon>\r\n\t\t\t\t\t\tCurrent Settings\r\n\t\t\t\t\t</v-tab>\r\n\t\t\t\t\t<v-tab href=\"#analysis\">\r\n\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-file</v-icon>\r\n\t\t\t\t\t\tMotion Analysis\r\n\t\t\t\t\t</v-tab>\r\n\t\t\t\t\t<!--<v-tab href=\"#comparison\">\r\n\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-compare-horizontal</v-icon>\r\n\t\t\t\t\t\tComparison\r\n\t\t\t\t\t</v-tab>-->\r\n\r\n\t\t\t\t\t<v-btn color=\"success\" class=\"align-self-center ml-auto mr-2 hidden-sm-and-down\" :disabled=\"uiFrozen\" @click=\"showDataCollection = true\">\r\n\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-record</v-icon>\r\n\t\t\t\t\t\tRecord Motion Profile\r\n\t\t\t\t\t</v-btn>\r\n\t\t\t\t</v-tabs>\r\n\r\n\t\t\t\t<v-tabs-items v-model=\"tab\">\r\n\t\t\t\t\t<!-- Current Settings -->\r\n\t\t\t\t\t<v-tab-item value=\"current\">\r\n\t\t\t\t\t\t<div class=\"d-flex flex-column\">\r\n\t\t\t\t\t\t\t<v-alert :value=\"!isInputShapingEnabled\" type=\"info\" class=\"mb-0\">\r\n\t\t\t\t\t\t\t\tInput Shaping is not configured. Record a new Motion Profile to set it up\r\n\t\t\t\t\t\t\t</v-alert>\r\n\t\t\t\t\t\t\t<div v-show=\"isInputShapingEnabled\" class=\"content flex-grow-1 pa-2\">\r\n\t\t\t\t\t\t\t\t<input-shaping-chart    :frequencies=\"currentFrequencies\" :ringing-frequency=\"frequency\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t:input-shapers=\"inputShapers\" :input-shaper-frequency=\"frequency\" :input-shaper-damping=\"damping\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t:custom-amplitudes=\"customAmplitudes\" :custom-durations=\"customDurations\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</v-tab-item>\r\n\r\n\t\t\t\t\t<!-- File Analysis -->\r\n\t\t\t\t\t<v-tab-item value=\"analysis\">\r\n\t\t\t\t\t\t<div class=\"d-flex flex-column\">\r\n\t\t\t\t\t\t\t<v-progress-linear :active=\"loadingFiles\" indeterminate/>\r\n\t\t\t\t\t\t\t<v-alert :value=\"files.length === 0 && !filesError\" type=\"info\" class=\"mb-0\">\r\n\t\t\t\t\t\t\t\tNo Motion Profiles found. Record a new Motion Profile or <a href=\"javascript:void(0)\" class=\"white--text text-decoration-underline\" @click=\"refresh\">refresh</a> the file list\r\n\t\t\t\t\t\t\t</v-alert>\r\n\t\t\t\t\t\t\t<v-alert :value=\"filesError\" type=\"error\" class=\"mb-0\">\r\n\t\t\t\t\t\t\t\t{{ filesError }}\r\n\t\t\t\t\t\t\t</v-alert>\r\n\t\t\t\t\t\t\t<v-row v-show=\"files.length > 0\" class=\"content pa-2\">\r\n\t\t\t\t\t\t\t\t<v-col cols=\"auto\" class=\"d-flex pa-0\">\r\n\t\t\t\t\t\t\t\t\t<input-shaping-file-list    title=\"Motion Profiles\" can-delete :files=\"files\" @refresh=\"refresh\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:selectedFiles.sync=\"filesToAnalyze\" :frequencies.sync=\"fileFrequenciesToAnalyze\" v-model=\"fileDataToAnalyze\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:sample-start-index.sync=\"sampleStartIndex\" :sample-end-index.sync=\"sampleEndIndex\" :had-overflow.sync=\"hadOverflow\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:estimate-shaper-effect.sync=\"estimateShaperEffect\" :show-original-values.sync=\"showOriginalValues\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t\t\t<v-col :class=\"!!filesToAnalyze.length ? 'd-none' : 'd-flex'\" class=\"align-center justify-center\">\r\n\t\t\t\t\t\t\t\t\tPlease select a Motion Profile\r\n\t\t\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t\t\t<v-col v-show=\"!!filesToAnalyze.length\" :class=\"!!filesToAnalyze.length ? 'd-flex' : 'd-none'\" class=\"flex-column pa-0\">\r\n\t\t\t\t\t\t\t\t\t<v-alert :value=\"hadOverflow\" type=\"warning\" class=\"mb-0\">\r\n\t\t\t\t\t\t\t\t\t\tThe selected motion profile contains overflows. It may not be accurate.\r\n\t\t\t\t\t\t\t\t\t</v-alert>\r\n\r\n\t\t\t\t\t\t\t\t\t<v-card outlined class=\"d-block fill-height pa-2\">\r\n\t\t\t\t\t\t\t\t\t\t<input-shaping-chart    can-show-samples :sample-start-index.sync=\"sampleStartIndex\" :sample-end-index.sync=\"sampleEndIndex\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:frequencies=\"fileFrequenciesToAnalyze\" :value=\"fileDataToAnalyze\" :ringing-frequency=\"frequency\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:input-shapers=\"inputShapers\" :input-shaper-frequency=\"frequency\" :input-shaper-damping=\"damping\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:custom-amplitudes=\"customAmplitudes\" :custom-durations=\"customDurations\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:estimate-shaper-effect=\"estimateShaperEffect\" :show-values=\"showOriginalValues\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</v-card>\r\n\t\t\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t\t</v-row>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</v-tab-item>\r\n\t\t\t\t</v-tabs-items>\r\n\t\t\t</v-card>\r\n\t\t</v-col>\r\n\r\n\t\t<v-col cols=\"auto\">\r\n\t\t\t<v-card tile>\r\n\t\t\t\t<v-card-title class=\"pb-2\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-transition</v-icon>\r\n\t\t\t\t\tInput Shapers\r\n\t\t\t\t</v-card-title>\r\n\t\t\t\t<v-card-text class=\"d-flex flex-column\">\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"none\" :current=\"shaping.type\" class=\"mt-0\"/>\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"mzv\" :current=\"shaping.type\"/>\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"zvd\" :current=\"shaping.type\"/>\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"zvdd\" :current=\"shaping.type\"/>\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"zvddd\" :current=\"shaping.type\"/>\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"ei2\" :current=\"shaping.type\"/>\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"ei3\" :current=\"shaping.type\"/>\r\n\t\t\t\t\t<!-- Cannot enable custom shapers before a missing enum value is rolled out as part of DSF 3.4.1+ -->\r\n\t\t\t\t\t<!--\r\n\t\t\t\t\t<input-shaper-checkbox v-model=\"inputShapers\" value=\"custom\" :current=\"shaping.type\">\r\n\t\t\t\t\t\t<v-menu v-model=\"customMenu\" offset-y left :close-on-content-click=\"false\" :max-width=\"380\" ref=\"customMenu\">\r\n\t\t\t\t\t\t\t<template #activator=\"{ on, attrs }\">\r\n\t\t\t\t\t\t\t\t<v-chip v-show=\"!uiFrozen\" small :color=\"shaping.type === 'custom' ? 'success' : 'info'\" v-bind=\"attrs\" v-on=\"on\">edit</v-chip>\r\n\t\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t\t<v-card>\r\n\t\t\t\t\t\t\t\t<v-card-title>\r\n\t\t\t\t\t\t\t\t\tCustom Shaper Configuration\r\n\t\t\t\t\t\t\t\t</v-card-title>\r\n\t\t\t\t\t\t\t\t<v-card-text class=\"pb-2\">\r\n\t\t\t\t\t\t\t\t\t<v-select v-model=\"numCustomCoefficients\" label=\"Number of Impulses\" :items=\"[0, 1,2,3,4]\" hide-details/>\r\n\t\t\t\t\t\t\t\t</v-card-text>\r\n\r\n\t\t\t\t\t\t\t\t<v-simple-table v-show=\"numCustomCoefficients > 0\">\r\n\t\t\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t<th class=\"text-center\">Impulse</th>\r\n\t\t\t\t\t\t\t\t\t\t<th>Amplitude</th>\r\n\t\t\t\t\t\t\t\t\t\t<th>Duration (in ms)</th>\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t\t<tr v-for=\"(_, index) in customAmplitudes\" :key=\"index\">\r\n\t\t\t\t\t\t\t\t\t\t<td class=\"text-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t{{ index + 1 }}\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-text-field type=\"number\" min=\"0\" step=\"0.001\" :value=\"customAmplitudes[index]\" @input=\"setCustomAmplitude(index, $event)\" class=\"pt-0 mb-1\" hide-details/>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-text-field type=\"number\" min=\"0\" step=\"0.1\" :value=\"customDurations[index] * 1000\" @input=\"setCustomDuration(index, $event)\" class=\"pt-0 mb-1\" hide-details/>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t</v-simple-table>\r\n\t\t\t\t\t\t\t\t<v-divider v-show=\"numCustomCoefficients > 0\"/>\r\n\r\n\t\t\t\t\t\t\t\t<v-card-text v-show=\"!!customShaperCode\" class=\"pb-0\">\r\n\t\t\t\t\t\t\t\t\t<label >Resulting configuration code:</label>\r\n\t\t\t\t\t\t\t\t\t<div class=\"d-flex\">\r\n\t\t\t\t\t\t\t\t\t\t<input ref=\"customShaperCode\" type=\"text\" :value=\"customShaperCode\" class=\"flex-grow-1\" readonly @click=\"$event.target.select()\" />\r\n\t\t\t\t\t\t\t\t\t\t<v-icon small class=\"ml-1\" @click=\"copy\">mdi-content-copy</v-icon>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</v-card-text>\r\n\r\n\t\t\t\t\t\t\t\t<v-card-actions class=\"justify-center\">\r\n\t\t\t\t\t\t\t\t\t<v-btn text :disabled=\"!canConfigureCustom\" :loading=\"configuringCustomShaper\" color=\"primary\" @click=\"configureCustomShaper\">\r\n\t\t\t\t\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-check</v-icon>\r\n\t\t\t\t\t\t\t\t\t\tApply\r\n\t\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t</v-card-actions>\r\n\t\t\t\t\t\t\t</v-card>\r\n\t\t\t\t\t\t</v-menu>\r\n\t\t\t\t\t</input-shaper-checkbox>\r\n\t\t\t\t\t-->\r\n\r\n\t\t\t\t\t<v-divider class=\"mt-3\"/>\r\n\r\n\t\t\t\t\t<v-text-field type=\"number\" min=\"10\" step=\"1\" max=\"1000\" v-model.number=\"frequency\" :disabled=\"uiFrozen\" label=\"Shaper centre frequency\" class=\"mt-3\" hide-details @keydown.enter.prevent=\"setFrequency\">\r\n\t\t\t\t\t\t<template #append>\r\n\t\t\t\t\t\t\tHz\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template #append-outer>\r\n\t\t\t\t\t\t\t<v-icon class=\"ml-1\" :disabled=\"!canSetFrequency\" @click=\"setFrequency\">mdi-check</v-icon>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</v-text-field>\r\n\r\n\t\t\t\t\t<v-text-field type=\"number\" min=\"0.01\" step=\"0.01\" max=\"0.99\" v-model.number=\"damping\" :disabled=\"uiFrozen\" label=\"Damping factor\" class=\"mt-3\" hide-details @keydown.enter.prevent=\"setDamping\">\r\n\t\t\t\t\t\t<template #append-outer>\r\n\t\t\t\t\t\t\t<v-icon class=\"ml-1\" :disabled=\"!canSetDamping\" @click=\"setDamping\">mdi-check</v-icon>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</v-text-field>\r\n\t\t\t\t</v-card-text>\r\n\t\t\t</v-card>\r\n\t\t</v-col>\r\n\r\n\t\t<record-motion-profile-dialog :last-run=\"lastRun\" :shown.sync=\"showDataCollection\" @finished=\"recordingFinished\"/>\r\n\t</v-row>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport Vue from 'vue'\r\nimport { mapState, mapGetters, mapActions } from 'vuex'\r\n\r\nimport Events from '@/utils/events.js'\r\nimport Path from '@/utils/path.js'\r\nimport { InputShapingType } from '@/store/machine/modelEnums'\r\n\r\nimport RecordMotionProfileDialog from './RecordMotionProfileDialog'\r\nimport InputShaperCheckbox from './InputShaperCheckbox'\r\nimport InputShapingChart from './InputShapingChart'\r\nimport InputShapingFileList from './InputShapingFileList'\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tRecordMotionProfileDialog,\r\n\t\tInputShaperCheckbox,\r\n\t\tInputShapingChart,\r\n\t\tInputShapingFileList\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState('machine/model', {\r\n\t\t\tshaping: state => state.move.shaping\r\n\t\t}),\r\n\t\t...mapState(['selectedMachine']),\r\n\t\t...mapGetters(['isConnected', 'uiFrozen']),\r\n\r\n\t\tisInputShapingEnabled() { return this.shaping.type !== InputShapingType.none; },\r\n\t\tcurrentFrequencies() { return Array.from({ length: 81 }, (_, index) => index + 10); },\r\n\r\n\t\tlastRun() {\r\n\t\t\tlet lastRun = 0;\r\n\t\t\tfor (let filename of this.files) {\r\n\t\t\t\tconst runMatch = /^(\\d+)-/.exec(filename);\r\n\t\t\t\tif (runMatch) {\r\n\t\t\t\t\tconst run = parseInt(runMatch[1]);\r\n\t\t\t\t\tif (run > lastRun) {\r\n\t\t\t\t\t\tlastRun = run;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn lastRun;\r\n\t\t},\r\n\r\n\t\tnumCustomCoefficients: {\r\n\t\t\tget() { return this.customAmplitudes.length; },\r\n\t\t\tset(value) {\r\n\t\t\t\tif (this.customAmplitudes.length > value) {\r\n\t\t\t\t\tthis.customAmplitudes.splice(value);\r\n\t\t\t\t\tthis.customDurations.splice(value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let i = this.customAmplitudes.length; i < value; i++) {\r\n\t\t\t\t\t\tthis.customAmplitudes.push(0);\r\n\t\t\t\t\t\tthis.customDurations.push(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcanConfigureCustom() {\r\n\t\t\treturn this.numCustomCoefficients > 0 && this.customAmplitudes.every(amplitude => amplitude > 0) && this.customDurations.every(duration => duration > 0);\r\n\t\t},\r\n\t\tcustomShaperCode() {\r\n\t\t\tif (this.inputShapers.includes('custom') && this.canConfigureCustom) {\r\n\t\t\t\tconst amplitudes = this.customAmplitudes.map(amplitude => amplitude.toFixed(3)).reduce((a, b) => a + ':' + b);\r\n\t\t\t\tconst durations = this.customDurations.map(duration => duration.toFixed(4)).reduce((a, b) => a + ':' + b);\r\n\t\t\t\treturn `M593 P\"custom\" H${amplitudes} T${durations}`;\r\n\t\t\t}\r\n\t\t\treturn '';\r\n\t\t},\r\n\t\tcanSetFrequency() {\r\n\t\t\treturn !this.uiFrozen && !isNaN(this.frequency) && this.frequency !== this.shaping.frequency;\r\n\t\t},\r\n\t\tcanSetDamping() {\r\n\t\t\treturn !this.uiFrozen && !isNaN(this.damping) && this.damping !== this.shaping.damping;\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttab: null,\r\n\t\t\tshowDataCollection: false,\r\n\r\n\t\t\tinputShapers: [],\r\n\t\t\tcustomAmplitudes: [],\r\n\t\t\tcustomDurations: [],\r\n\t\t\tcustomMenu: false,\r\n\t\t\tconfiguringCustomShaper: false,\r\n\t\t\tfrequency: 0,\r\n\t\t\tdamping: 0.1,\r\n\r\n\t\t\tfiles: [],\r\n\t\t\tloadingFiles: false,\r\n\t\t\tfilesError: null,\r\n\r\n\t\t\tfilesToAnalyze: [],\r\n\t\t\tfileFrequenciesToAnalyze: [],\r\n\t\t\tfileDataToAnalyze: null,\r\n\t\t\tshowOriginalValues: true,\r\n\t\t\testimateShaperEffect: false,\r\n\t\t\tsampleStartIndex: null,\r\n\t\t\tsampleEndIndex: null,\r\n\t\t\thadOverflow: false\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['getFileList', 'sendCode']),\r\n\r\n\t\t// Recorder\r\n\t\trecordingFinished() {\r\n\t\t\tthis.tab = 'analysis';\r\n\t\t\tthis.refresh();\r\n\t\t},\r\n\r\n\t\t// Input Shaper Settings\r\n\t\tsetCustomAmplitude(index, value) {\r\n\t\t\tconst val = parseFloat(value);\r\n\t\t\tif (!isNaN(val) && val >= 0) {\r\n\t\t\t\tVue.set(this.customAmplitudes, index, val);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetCustomDuration(index, value) {\r\n\t\t\tconst val = parseFloat(value);\r\n\t\t\tif (!isNaN(val) && val >= 0) {\r\n\t\t\t\tVue.set(this.customDurations, index, val / 1000);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcopy() {\r\n\t\t\tthis.$refs.customShaperCode.focus();\r\n\t\t\tthis.$refs.customShaperCode.select();\r\n\t\t\tdocument.execCommand('copy');\r\n\t\t},\r\n\t\tasync configureCustomShaper() {\r\n\t\t\tthis.configuringCustomShaper = true;\r\n\t\t\ttry {\r\n\t\t\t\tawait this.sendCode(this.customShaperCode);\r\n\t\t\t} finally {\r\n\t\t\t\tthis.customMenu = this.configuringCustomShaper = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync setFrequency() {\r\n\t\t\tif (this.canSetFrequency) {\r\n\t\t\t\tawait this.sendCode(`M593 F${this.frequency}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync setDamping() {\r\n\t\t\tif (this.canSetDamping) {\r\n\t\t\t\tawait this.sendCode(`M593 S${this.damping}`);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Files\r\n\t\tasync refresh() {\r\n\t\t\tif (!this.isConnected) {\r\n\t\t\t\tthis.files = [];\r\n\t\t\t\tthis.loadingFiles = false;\r\n\t\t\t\tthis.errorMessage = null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.loadingFiles) {\r\n\t\t\t\t// Don't do multiple actions at once\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.loadingFiles = true;\r\n\t\t\ttry {\r\n\t\t\t\tconst files = (await this.getFileList(Path.accelerometer)).filter(file => !file.isDirectory && file.name !== Path.filamentsFile && file.name.endsWith('.csv'));\r\n\t\t\t\tfiles.sort((a, b) => new Date(b.lastModified) - new Date(a.lastModified));\r\n\t\t\t\tthis.files = files.map(file => file.name);\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loadingFiles = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tfilesOrDirectoriesChanged({ machine, files }) {\r\n\t\t\tif (machine === this.selectedMachine) {\r\n\t\t\t\tif (this.filesToAnalyze.some(fileToAnalyze => files.includes(Path.combine(Path.accelerometer, fileToAnalyze)))) {\r\n\t\t\t\t\t// Current file being analyzed has bene changed, invalidate it\r\n\t\t\t\t\tthis.filesToAnalyze = [];\r\n\t\t\t\t} else if (files.some(file => file.endsWith('.csv')) && Path.filesAffectDirectory(files, Path.accelerometer)) {\r\n\t\t\t\t\t// CSV file or directory has been changed\r\n\t\t\t\t\tthis.refresh();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\t// Reload the file list\r\n\t\tthis.refresh();\r\n\r\n\t\t// Init the current values\r\n\t\tif (this.shaping.type === 'none') {\r\n\t\t\tthis.inputShapers = [];\r\n\t\t} else {\r\n\t\t\tthis.inputShapers.push(this.shaping.type);\r\n\t\t}\r\n\t\tthis.frequency = this.shaping.frequency;\r\n\t\tthis.damping = this.shaping.damping;\r\n\t\tthis.customAmplitudes = this.shaping.amplitudes.slice();\r\n\t\tthis.customDurations = this.shaping.durations.slice();\r\n\r\n\t\t// Keep track of file changes\r\n\t\tthis.$root.$on(Events.filesOrDirectoriesChanged, this.filesOrDirectoriesChanged);\r\n\t},\r\n\tbeforeDestroy() {\r\n\t\t// No longer keep track of file changes\r\n\t\tthis.$root.$off(Events.filesOrDirectoriesChanged, this.filesOrDirectoriesChanged);\r\n\t},\r\n\twatch: {\r\n\t\t'shaping.type'(to) {\r\n\t\t\tif (to === 'none') {\r\n\t\t\t\tthis.inputShapers = [];\r\n\t\t\t} else {\r\n\t\t\t\tif (!this.inputShapers.includes(to)) {\r\n\t\t\t\t\tthis.inputShapers.push(to);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (to === 'custom') {\r\n\t\t\t\t\tthis.customAmplitudes = this.shaping.amplitudes.slice();\r\n\t\t\t\t\tthis.customDurations = this.shaping.durations.slice();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t'shaping.amplitudes': {\r\n\t\t\tdeep: true,\r\n\t\t\thandler(to) {\r\n\t\t\t\tif (!this.inputShapers.includes('custom') || this.shaping.type === 'custom') {\r\n\t\t\t\t\tthis.customAmplitudes = to.slice();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t'shaping.durations': {\r\n\t\t\tdeep: true,\r\n\t\t\thandler(to) {\r\n\t\t\t\tif (!this.inputShapers.includes('custom') || this.shaping.type === 'custom') {\r\n\t\t\t\t\tthis.customDurations = to.slice();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t'shaping.frequency'(to) {\r\n\t\t\tthis.frequency = to;\r\n\t\t},\r\n\t\t'shaping.damping'(to) {\r\n\t\t\tthis.damping = to;\r\n\t\t},\r\n\t\tnumCustomCoefficients() {\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tif (this.$refs.customMenu) {\r\n\t\t\t\t\tthis.$refs.customMenu.updateDimensions();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tselectedMachine() {\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n","<template>\r\n\t<canvas ref=\"chart\" @mousedown=\"mouseDown\" @mousemove=\"mouseMove\" @dblclick=\"doubleClick\"></canvas>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport Chart from 'chart.js'\r\nimport { mapState } from 'vuex'\r\n\r\nimport './RangePlugin'\r\nimport './VLinePlugin'\r\nimport { getInputShaperDamping, getInputShaperFactors, InputShaperType } from '@duet3d/motionanalysis/dist/shapers'\r\n\r\nexport default {\r\n\tprops: {\r\n\t\tfrequencies: Array,                 // array of the frequencies used (omit this if samples shall be displayed)\r\n\t\tringingFrequency: Number,           // frequency to highlight (requires frequencies)\r\n\t\tvalue: Object,                      // object map of the Y axis label vs. displayed value (e.g. { X: [ ... ] })\r\n\t\tshowValues: {                       // whether the values are supposed to be shown as datasets\r\n\t\t\tdefault: true,\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\t\tsampleStartIndex: Number,           // start sample index to show\r\n\t\tsampleEndIndex: Number,             // end sample index to show\r\n\r\n\t\tinputShapers: Array,                // compute damping curves for these input shapers (requires frequencies)\r\n\t\tinputShaperFrequency: Number,       // frequency to use when computing input shaper damping curves\r\n\t\tinputShaperDamping: Number,         // damping factor to use when computing input shaper damping curves\r\n\r\n\t\tcustomAmplitudes: Array,            // amplitudes for the computation of the custom input shaper\r\n\t\tcustomDurations: Array,             // durations for the computation of the custom input shaper\r\n\r\n\t\testimateShaperEffect: Boolean       // show estimated shaper effect\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState('settings', ['darkTheme']),\r\n\t\tshowReduction() { return ((this.amplitudes && this.durations) || (!!this.inputShapers && this.inputShapers.length > 0)) && !this.estimateShaperEffect; },\r\n\t\tresolution() { return (this.frequencies && this.frequencies.length > 2) ? (this.frequencies[1] - this.frequencies[0]) : 0; },\r\n\t\tlineAtPoint() {\r\n\t\t\tlet point = -1;\r\n\t\t\tif (this.frequencies && this.frequencies.length > 1 && this.ringingFrequency) {\r\n\t\t\t\tlet delta;\r\n\t\t\t\tfor (let i = 0; i < this.frequencies.length; i++) {\r\n\t\t\t\t\tconst nextDelta = Math.abs(this.frequencies[i] - this.ringingFrequency);\r\n\t\t\t\t\tif (point === -1 || nextDelta < delta) {\r\n\t\t\t\t\t\tpoint = i;\r\n\t\t\t\t\t\tdelta = nextDelta;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (delta > this.resolution) {\r\n\t\t\t\t\t// Don't attempt to display the target frequency if it is too far off\r\n\t\t\t\t\tpoint = -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn point;\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tchart: null,\r\n\t\t\toptions: {},\r\n\t\t\tdragStart: null,\r\n\t\t\tisUpdating: false\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\t// TODO: Update translations here -----v\r\n\t\tconst that = this;\r\n\t\tthis.options = {\r\n\t\t\tanimation: false,\r\n\t\t\thover: {\r\n\t\t\t\tmode: 'nearest',\r\n\t\t\t\tintersect: true\r\n\t\t\t},\r\n\t\t\tlegend: {\r\n\t\t\t\tlabels: {},\r\n\t\t\t\tonClick(e, legendItem) {\r\n\t\t\t\t\tconst index = legendItem.datasetIndex;\r\n\t\t\t\t\tconst ci = this.chart;\r\n\t\t\t\t\tconst meta = ci.getDatasetMeta(index);\r\n\r\n\t\t\t\t\t// See controller.isDatasetVisible comment\r\n\t\t\t\t\tmeta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;\r\n\r\n\t\t\t\t\t// Toggle visibility of the highlighted frequency\r\n\t\t\t\t\tif (ci.data.datasets[index].isShaperFrequency) {\r\n\t\t\t\t\t\tci.config.lineAtIndex = meta.hidden ? [] : [that.lineAtPoint];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// We hid a dataset ... rerender the chart\r\n\t\t\t\t\tci.update();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmaintainAspectRatio: false,\r\n\t\t\tplugins: {\r\n\t\t\t\trange: {},\r\n\t\t\t\tvline: {\r\n\t\t\t\t\tlineColor: '#1010FF',\r\n\t\t\t\t\tlineWidth: 2\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tscales: {\r\n\t\t\t\txAxes: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\tgridLines: {\r\n\t\t\t\t\t\t\tdisplay: true\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tscaleLabel: {\r\n\t\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\t\tlabelString: (this.frequencies && this.frequencies.length > 0) ? 'Frequency (in Hz)' : 'Sample'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tticks: {\r\n\t\t\t\t\t\t\tminor: {\r\n\t\t\t\t\t\t\t\tfontFamily: 'Roboto,sans-serif'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tmajor: {\r\n\t\t\t\t\t\t\t\tfontFamily: 'Roboto,sans-serif'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tbeginAtZero: true,\r\n\t\t\t\t\t\t\tmaxTicksLimit: 20\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tyAxes: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdisplay: !!this.value,\r\n\t\t\t\t\t\tgridLines: {\r\n\t\t\t\t\t\t\tdisplay: true\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tscaleLabel: {\r\n\t\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\t\tlabelString: (this.frequencies && this.frequencies.length > 0) ? 'Amplitude' : 'Acceleration (in g)'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tticks: {\r\n\t\t\t\t\t\t\tminor: {\r\n\t\t\t\t\t\t\t\tfontFamily: 'Roboto,sans-serif'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tmajor: {\r\n\t\t\t\t\t\t\t\tfontFamily: 'Roboto,sans-serif'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdisplay: this.showReduction,\r\n\t\t\t\t\t\tgridLines: {\r\n\t\t\t\t\t\t\tdisplay: true\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tid: 'damping',\r\n\t\t\t\t\t\tposition: this.value ? 'right' : 'left',\r\n\t\t\t\t\t\tscaleLabel: {\r\n\t\t\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\t\t\tlabelString: 'Reduction Factor'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tticks: {\r\n\t\t\t\t\t\t\tmin: 0,\r\n\t\t\t\t\t\t\tmax: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\ttooltips: {\r\n\t\t\t\tenabled: true,\r\n\t\t\t\tcallbacks: {\r\n\t\t\t\t\tlabel(tooltipItem, data) {\r\n\t\t\t\t\t\tlet label = data.datasets[tooltipItem.datasetIndex].label || '';\r\n\t\t\t\t\t\tif (label) {\r\n\t\t\t\t\t\t\tlabel += ': ';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlabel += that.estimateShaperEffect ? Math.round(tooltipItem.yLabel * 10000) / 10000 : Math.round(tooltipItem.yLabel * 1000) / 1000;\r\n\t\t\t\t\t\treturn label;\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttitle: items => that.frequencies\r\n\t\t\t\t\t\t? that.$t('plugins.accelerometer.frequencyTooltip', [that.frequencies[items[0].index].toFixed(1), (that.resolution / 2).toFixed(1)])\r\n\t\t\t\t\t\t: that.$t('plugins.accelerometer.sampleTooltip', [items[0].index + 1])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Create the chart\r\n\t\tthis.chart = Chart.Line(this.$refs.chart, {\r\n\t\t\toptions: this.options,\r\n\t\t\tdata: {\r\n\t\t\t\tdatasets: [],\r\n\t\t\t\tlabels: []\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.updateDatasets();\r\n\t\tthis.applyDarkTheme(this.darkTheme);\r\n\t},\r\n\tmethods: {\r\n\t\tapplyDarkTheme(active) {\r\n\t\t\tconst ticksColor = active ? '#FFF' : '#666';\r\n\t\t\tthis.chart.config.options.legend.labels.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.xAxes[0].ticks.minor.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.xAxes[0].ticks.major.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.xAxes[0].scaleLabel.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[0].ticks.major.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[0].ticks.minor.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[0].scaleLabel.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[1].ticks.major.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[1].ticks.minor.fontColor = ticksColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[1].scaleLabel.fontColor = ticksColor;\r\n\r\n\t\t\tconst gridLineColor = active ? 'rgba(255,255,255,0.15)' : 'rgba(0,0,0,0.15)';\r\n\t\t\tthis.chart.config.options.scales.xAxes[0].gridLines.color = gridLineColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[0].gridLines.color = gridLineColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[0].gridLines.zeroLineColor = gridLineColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[1].gridLines.color = gridLineColor;\r\n\t\t\tthis.chart.config.options.scales.yAxes[1].gridLines.zeroLineColor = gridLineColor;\r\n\r\n\t\t\tthis.chart.update();\r\n\t\t},\r\n\t\tgetLineColor(index) {\r\n\t\t\tconst colors = [\r\n\t\t\t\t'#4dc9f6',\r\n\t\t\t\t'#f67019',\r\n\t\t\t\t'#f53794',\r\n\t\t\t\t'#537bc4',\r\n\t\t\t\t'#acc236',\r\n\t\t\t\t'#166a8f',\r\n\t\t\t\t'#00a950',\r\n\t\t\t\t'#58595b',\r\n\t\t\t\t'#8549ba'\r\n\t\t\t];\r\n\t\t\treturn colors[index % colors.length];\r\n\t\t},\r\n\t\tupdateDatasets() {\r\n\t\t\tconst hiddenDatasets = this.chart.data.datasets.filter((_, index) => !this.chart.isDatasetVisible(index)).map(dataset => dataset.label);\r\n\t\t\tthis.chart.data.labels = [];\r\n\t\t\tthis.chart.data.datasets = [];\r\n\r\n\t\t\t// Add values\r\n\t\t\tlet numSamples = 0;\r\n\t\t\tfor (let key in this.value) {\r\n\t\t\t\tif (this.showValues) {\r\n\t\t\t\t\tconst dataset = {\r\n\t\t\t\t\t\tborderColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\tbackgroundColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\tpointBorderWidth: 0.25,\r\n\t\t\t\t\t\tpointRadius: 2,\r\n\t\t\t\t\t\tborderWidth: 1.25,\r\n\t\t\t\t\t\tdata: this.value[key],\r\n\t\t\t\t\t\tfill: false,\r\n\t\t\t\t\t\tlabel: key\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.chart.data.datasets.push(dataset);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.value[key].length > numSamples) {\r\n\t\t\t\t\tnumSamples = this.value[key].length;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Set frequencies or samples\r\n\t\t\tthis.chart.config.options.scales.xAxes[0].ticks.min = 0;\r\n\t\t\tthis.chart.config.options.scales.xAxes[0].ticks.max = numSamples;\r\n\t\t\tthis.chart.data.labels = (this.frequencies && this.frequencies.length > 0) ? this.frequencies.map(freq => Math.round(freq).toString()) : Array.from({ length: numSamples }, (_, i) => i);\r\n\r\n\t\t\t// Check if a frequency is supposed to be highlighted\r\n\t\t\tif (this.lineAtPoint !== -1 && this.chart.data.datasets.length > 0) {\r\n\t\t\t\tthis.chart.config.lineAtIndex = [this.lineAtPoint];\r\n\r\n\t\t\t\tconst dataset = {\r\n\t\t\t\t\tborderColor: '#1010FF',\r\n\t\t\t\t\tbackgroundColor: '#1010FF',\r\n\t\t\t\t\tdata: [],\r\n\t\t\t\t\tlabel: 'Shaper Frequency',\r\n\t\t\t\t\tisShaperFrequency: true\r\n\t\t\t\t};\r\n\t\t\t\tthis.chart.data.datasets.push(dataset);\r\n\t\t\t} else {\r\n\t\t\t\tthis.chart.config.lineAtIndex = [];\r\n\t\t\t}\r\n\r\n\t\t\t// Compute the damping curves for the given shapers\r\n\t\t\tif (this.inputShaperFrequency && this.frequencies && this.frequencies.length > 0) {\r\n\t\t\t\tfor (let shaperType of this.inputShapers) {\r\n\t\t\t\t\tif (shaperType === 'none' || shaperType === 'custom') {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else if (!(shaperType in InputShaperType)) {\r\n\t\t\t\t\t\tconsole.warn(`Unsupported shaper type ${shaperType}`);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst factors = getInputShaperFactors(shaperType, this.inputShaperFrequency, this.inputShaperDamping);\r\n\t\t\t\t\tconst damping = getInputShaperDamping(this.frequencies, factors.amplitudes, factors.durations);\r\n\r\n\t\t\t\t\tif (this.estimateShaperEffect) {\r\n\t\t\t\t\t\tfor (let key in this.value) {\r\n\t\t\t\t\t\t\tconst dataset = {\r\n\t\t\t\t\t\t\t\tborderColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\t\t\tbackgroundColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\t\t\tpointBorderWidth: 0.25,\r\n\t\t\t\t\t\t\t\tpointRadius: 0,\r\n\t\t\t\t\t\t\t\tborderDash: this.showValues ? [5, 5] : undefined,\r\n\t\t\t\t\t\t\t\tborderWidth: 1.25,\r\n\t\t\t\t\t\t\t\tdata: this.value[key].map((value, index) => value * damping[index]),\r\n\t\t\t\t\t\t\t\tfill: false,\r\n\t\t\t\t\t\t\t\tlabel: `${key} + ${shaperType.toUpperCase()}`\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tthis.chart.data.datasets.push(dataset);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst dataset = {\r\n\t\t\t\t\t\t\tborderColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\t\tbackgroundColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\t\tpointBorderWidth: 0,\r\n\t\t\t\t\t\t\tpointRadius: 0,\r\n\t\t\t\t\t\t\tborderDash: [5, 5],\r\n\t\t\t\t\t\t\tborderWidth: 1.25,\r\n\t\t\t\t\t\t\tdata: damping,\r\n\t\t\t\t\t\t\tfill: false,\r\n\t\t\t\t\t\t\tlabel: shaperType.toUpperCase(),\r\n\t\t\t\t\t\t\tyAxisID: 'damping'\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.chart.data.datasets.push(dataset);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Compute the damping curve for custom parameters\r\n\t\t\tif (this.inputShapers.includes('custom') && this.frequencies && this.frequencies.length > 0 && this.customAmplitudes && this.customDurations && this.customAmplitudes.length > 0 && this.customDurations.length > 0) {\r\n\t\t\t\tconst damping = getInputShaperDamping(this.frequencies, this.customAmplitudes, this.customDurations);\r\n\t\t\t\tif (this.estimateShaperEffect) {\r\n\t\t\t\t\tfor (let key in this.value) {\r\n\t\t\t\t\t\tconst dataset = {\r\n\t\t\t\t\t\t\tborderColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\t\tbackgroundColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\t\tpointBorderWidth: 0,\r\n\t\t\t\t\t\t\tpointRadius: 0,\r\n\t\t\t\t\t\t\tborderDash: this.showValues ? [5, 5] : undefined,\r\n\t\t\t\t\t\t\tborderWidth: 1.25,\r\n\t\t\t\t\t\t\tdata: this.value[key].map((value, index) => value * damping[index]),\r\n\t\t\t\t\t\t\tfill: false,\r\n\t\t\t\t\t\t\tlabel: `${key} + Custom`\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.chart.data.datasets.push(dataset);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst dataset = {\r\n\t\t\t\t\t\tborderColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\tbackgroundColor: this.getLineColor(this.chart.data.datasets.length),\r\n\t\t\t\t\t\tpointBorderWidth: 0,\r\n\t\t\t\t\t\tpointRadius: 0,\r\n\t\t\t\t\t\tborderDash: [10, 5],\r\n\t\t\t\t\t\tborderWidth: 1.25,\r\n\t\t\t\t\t\tdata: damping,\r\n\t\t\t\t\t\tfill: false,\r\n\t\t\t\t\t\tlabel: 'Custom',\r\n\t\t\t\t\t\tyAxisID: 'damping',\r\n\t\t\t\t\t\tisCustom: true\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.chart.data.datasets.push(dataset);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Check if a frequency is supposed to be highlighted. Attempt to add this here again in case it wasn't added before\r\n\t\t\tif (!this.chart.data.datasets.find(dataset => dataset.isShaperFrequency) && this.lineAtPoint !== -1 && this.chart.data.datasets.length > 0) {\r\n\t\t\t\tthis.chart.config.lineAtIndex = [this.lineAtPoint];\r\n\r\n\t\t\t\tconst dataset = {\r\n\t\t\t\t\tborderColor: '#1010FF',\r\n\t\t\t\t\tbackgroundColor: '#1010FF',\r\n\t\t\t\t\tdata: [],\r\n\t\t\t\t\tlabel: 'Shaper Frequency',\r\n\t\t\t\t\tisShaperFrequency: true\r\n\t\t\t\t};\r\n\t\t\t\tthis.chart.data.datasets.push(dataset);\r\n\t\t\t}\r\n\r\n\t\t\t// Limit number of frequencies\r\n\t\t\tif (this.frequencies && this.frequencies.length > 0) {\r\n\t\t\t\tlet maxFrequencyIndex = -1;\r\n\t\t\t\tfor (let freq of this.frequencies) {\r\n\t\t\t\t\tif (Math.round(freq) > 100) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmaxFrequencyIndex++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (maxFrequencyIndex > 0) {\r\n\t\t\t\t\tfor (let dataset of this.chart.data.datasets) {\r\n\t\t\t\t\t\tif (!this.isShaperFrequency) {\r\n\t\t\t\t\t\t\tdataset.data.splice(maxFrequencyIndex + 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.chart.data.labels.splice(maxFrequencyIndex + 1);\r\n\t\t\t\t\tthis.chart.config.options.scales.xAxes[0].ticks.max = maxFrequencyIndex;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Finish setup\r\n\t\t\tthis.chart.options.scales.xAxes[0].scaleLabel.labelString = (this.frequencies && this.frequencies.length > 0) ? 'Frequency (in Hz)' : 'Sample';\r\n\t\t\tthis.chart.options.scales.yAxes[0].scaleLabel.labelString = (this.frequencies && this.frequencies.length > 0) ? 'Amplitude' : 'Acceleration (in g)';\r\n\t\t\tthis.chart.options.scales.yAxes[0].display = !!this.value;\r\n\t\t\tthis.chart.options.scales.yAxes[1].display = this.showReduction;\r\n\t\t\tthis.chart.options.scales.yAxes[1].position = this.value ? 'right' : 'left';\r\n\t\t\tfor (let dataset of this.chart.data.datasets) {\r\n\t\t\t\tif (hiddenDatasets.includes(dataset.label)) {\r\n\t\t\t\t\tdataset.hidden = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tupdate() {\r\n\t\t\tif (!this.isUpdating) {\r\n\t\t\t\tthis.isUpdating = true;\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.updateDatasets();\r\n\t\t\t\t\tthis.chart.update();\r\n\t\t\t\t\tthis.isUpdating = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tmouseDown(e) {\r\n\t\t\tif (this.frequencies && this.frequencies.length > 0) {\r\n\t\t\t\t// selection is only possible when viewing samples\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst activePoints = this.chart.getElementsAtEventForMode(e, 'nearest', { intersect: false });\r\n\t\t\tif (activePoints && activePoints.length > 0) {\r\n\t\t\t\tthis.dragStart = activePoints[0]._index;\r\n\t\t\t\tthis.chart.config.range = { start: e.layerX };\r\n\t\t\t\tthis.chart.update();\r\n\r\n\t\t\t\tdocument.addEventListener('mouseup', this.mouseUp);\r\n\t\t\t}\r\n\t\t},\r\n\t\tmouseMove(e) {\r\n\t\t\tif (this.chart.config.range) {\r\n\t\t\t\tthis.chart.config.range.end = e.layerX;\r\n\t\t\t\tthis.chart.update();\r\n\t\t\t}\r\n\t\t},\r\n\t\tmouseUp(e) {\r\n\t\t\tdocument.removeEventListener('mouseup', this.mouseUp);\r\n\r\n\t\t\tif (this.chart.config.range && this.chart.config.range.end) {\r\n\t\t\t\tconst activePoints = this.chart.getElementsAtEventForMode(e, 'nearest', {intersect: false});\r\n\t\t\t\tif (activePoints && activePoints.length > 0) {\r\n\t\t\t\t\tconst dragEnd = activePoints[0]._index;\r\n\t\t\t\t\tif (Math.abs(dragEnd - this.dragStart) > 4) {\r\n\t\t\t\t\t\tconst trueStart = Math.min(this.dragStart, dragEnd), trueEnd = Math.max(this.dragStart, dragEnd);\r\n\t\t\t\t\t\tthis.$emit('update:sampleStartIndex', trueStart);\r\n\t\t\t\t\t\tthis.$emit('update:sampleEndIndex', trueEnd);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.dragStart = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.chart.config.range = null;\r\n\t\t\tthis.chart.update();\r\n\t\t},\r\n\t\tmouseLeave() {\r\n\t\t\tif (this.chart.config.range) {\r\n\t\t\t\tthis.chart.config.range = null;\r\n\t\t\t\tthis.chart.update();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdoubleClick() {\r\n\t\t\tthis.$emit('update:sampleStartIndex', null);\r\n\t\t\tthis.$emit('update:sampleEndIndex', null);\r\n\t\t},\r\n\t\tarraysDiffer(a, b) {\r\n\t\t\tif (a instanceof Array && b instanceof Array) {\r\n\t\t\t\tif (a.length !== b.length) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tfor (let i = 0; i < a.length; i++) {\r\n\t\t\t\t\tconst aItem = a[i], bItem = b[i];\r\n\t\t\t\t\tif (aItem instanceof Array && bItem instanceof Array) {\r\n\t\t\t\t\t\tif (aItem.length !== bItem.length) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let k = 0; k < aItem.length; k++) {\r\n\t\t\t\t\t\t\tif (aItem[k] !== bItem[k]) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (a[i] !== b[i]) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tfrequencies(to, from) { if (this.arraysDiffer(to, from)) { this.update(); } },\r\n\t\tringingFrequency() { this.update(); },\r\n\t\tvalue() { this.update(); },\r\n\t\tshowValues() { this.update(); },\r\n\r\n\t\tinputShapers: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler(to, from) { if (this.arraysDiffer(to, from)) { this.update(); } }\r\n\t\t},\r\n\t\tinputShaperFrequency() { this.update(); },\r\n\t\tinputShaperDamping() { this.update(); },\r\n\r\n\t\tcustomAmplitudes: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler() {\r\n\t\t\t\tif (this.customAmplitudes && this.customDurations) {\r\n\t\t\t\t\tfor (let dataset in this.chart.data.datasets) {\r\n\t\t\t\t\t\tif (dataset.isCustom) {\r\n\t\t\t\t\t\t\tdataset.data = getInputShaperDamping(this.frequencies, this.customAmplitudes, this.customDurations);\r\n\t\t\t\t\t\t\tthis.update();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.update();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcustomDurations: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler() {\r\n\t\t\t\tif (this.customAmplitudes && this.customDurations) {\r\n\t\t\t\t\tfor (let dataset in this.chart.data.datasets) {\r\n\t\t\t\t\t\tif (dataset.isCustom) {\r\n\t\t\t\t\t\t\tdataset.data = getInputShaperDamping(this.frequencies, this.customAmplitudes, this.customDurations);\r\n\t\t\t\t\t\t\tthis.update();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.update();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdarkTheme(to) {\r\n\t\t\tthis.applyDarkTheme(to);\r\n\t\t},\r\n\t\tlanguage() {\r\n\t\t\t// TODO!\r\n\t\t\t/*\r\n\t\t\tthis.chart.options.scales.xAxes[0].scaleLabel.labelString = this.$t(this.displaySamples ? 'plugins.accelerometer.samples' : 'plugins.accelerometer.frequency');\r\n\t\t\tthis.chart.options.scales.yAxes[0].scaleLabel.labelString = this.$t(this.displaySamples ? 'plugins.accelerometer.accelerations' : 'plugins.accelerometer.amplitudes');\r\n\t\t\tthis.update();\r\n\t\t\t */\r\n\t\t},\r\n\t\tsampleStartIndex(to) {\r\n\t\t\tif (!this.frequencies || this.frequencies.length === 0) {\r\n\t\t\t\tthis.chart.config.options.scales.xAxes[0].ticks.min = isNaN(to) ? 0 : to;\r\n\t\t\t\tthis.chart.update();\r\n\t\t\t}\r\n\t\t},\r\n\t\tsampleEndIndex(to) {\r\n\t\t\tif (!this.frequencies || this.frequencies.length === 0) {\r\n\t\t\t\tthis.chart.config.options.scales.xAxes[0].ticks.max = isNaN(to) ? this.chart.data.datasets.labels.length : to;\r\n\t\t\t\tthis.chart.update();\r\n\t\t\t}\r\n\t\t},\r\n\t\testimateShaperEffect() { this.update(); }\r\n\t}\r\n}\r\n</script>\r\n","<style scoped>\r\n.no-overflow {\r\n\ttext-overflow: clip\r\n}\r\n.no-wrap {\r\n\tflex-wrap: nowrap;\r\n\twhite-space: nowrap;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-card flat class=\"d-flex flex-column\">\r\n\t\t<v-card-title class=\"pt-2 pb-1 no-wrap\">\r\n\t\t\t<v-icon class=\"mr-2\">mdi-format-list-bulleted</v-icon> {{ title }}\r\n\t\t\t<v-spacer/>\r\n\t\t\t<v-icon class=\"ml-2\" :disabled=\"uiFrozen\" @click=\"$emit('refresh')\">mdi-refresh</v-icon>\r\n\t\t</v-card-title>\r\n\r\n\t\t<v-card-text class=\"pa-0\" v-show=\"files.length === 0\">\r\n\t\t\t<v-alert :value=\"true\" type=\"info\" class=\"mb-0\">\r\n\t\t\t\tNo Profiles\r\n\t\t\t</v-alert>\r\n\t\t</v-card-text>\r\n\t\t<v-progress-linear :active=\"progress !== progressMax\" :value=\"(progress / progressMax) * 100\"/>\r\n\r\n\t\t<template v-if=\"profiles.length > 0\">\r\n\t\t\t<template v-if=\"!individualFiles\">\r\n\t\t\t\t<v-list class=\"py-0\" :disabled=\"uiFrozen || progress !== progressMax\" dense>\r\n\t\t\t\t\t<v-list-item-group color=\"primary\" v-model=\"selection\">\r\n\t\t\t\t\t\t<v-list-item v-for=\"(profile, index) in profiles\" :key=\"index\" :value=\"profile.files.map(item => item.filename)\" two-line v-ripple>\r\n\t\t\t\t\t\t\t<v-list-item-icon class=\"align-self-center\">\r\n\t\t\t\t\t\t\t\t<v-icon>\r\n\t\t\t\t\t\t\t\t\t{{ profile.icon }}\r\n\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t</v-list-item-icon>\r\n\t\t\t\t\t\t\t<v-list-item-content>\r\n\t\t\t\t\t\t\t\t<v-list-item-title class=\"no-overflow\">\r\n\t\t\t\t\t\t\t\t\t{{ profile.title }}\r\n\t\t\t\t\t\t\t\t</v-list-item-title>\r\n\t\t\t\t\t\t\t\t<v-list-item-subtitle class=\"no-overflow\">\r\n\t\t\t\t\t\t\t\t\t{{ profile.subtitle }}\r\n\t\t\t\t\t\t\t\t</v-list-item-subtitle>\r\n\t\t\t\t\t\t\t</v-list-item-content>\r\n\t\t\t\t\t\t\t<v-list-item-icon v-if=\"canDelete\" class=\"align-self-center\" @click.stop.prevent=\"deleteProfile(profile)\">\r\n\t\t\t\t\t\t\t\t<v-icon>\r\n\t\t\t\t\t\t\t\t\tmdi-delete\r\n\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t</v-list-item-icon>\r\n\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t</v-list-item-group>\r\n\t\t\t\t</v-list>\r\n\t\t\t</template>\r\n\t\t\t<template v-else>\r\n\t\t\t\t<v-list class=\"py-0\" :disabled=\"uiFrozen || progress !== progressMax\" dense>\r\n\t\t\t\t\t<v-list-group v-for=\"(profile, index) in profiles\" :key=\"index\">\r\n\t\t\t\t\t\t<template #activator>\r\n\t\t\t\t\t\t\t<v-list-item-icon class=\"align-self-center\">\r\n\t\t\t\t\t\t\t\t<v-icon>\r\n\t\t\t\t\t\t\t\t\t{{ profile.icon }}\r\n\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t</v-list-item-icon>\r\n\t\t\t\t\t\t\t<v-list-item-content>\r\n\t\t\t\t\t\t\t\t<v-list-item-title class=\"no-overflow\">\r\n\t\t\t\t\t\t\t\t\t{{ profile.title }}\r\n\t\t\t\t\t\t\t\t</v-list-item-title>\r\n\t\t\t\t\t\t\t\t<v-list-item-subtitle class=\"no-overflow\">\r\n\t\t\t\t\t\t\t\t\t{{ profile.subtitle }}\r\n\t\t\t\t\t\t\t\t</v-list-item-subtitle>\r\n\t\t\t\t\t\t\t</v-list-item-content>\r\n\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t<v-list-item-group v-model=\"selection\">\r\n\t\t\t\t\t\t\t<v-list-item v-for=\"(file, fileIndex) in profile.files\" :key=\"fileIndex\" :value=\"[file.filename]\" v-ripple>\r\n\t\t\t\t\t\t\t\t<v-list-item-icon>\r\n\t\t\t\t\t\t\t\t\t<v-icon>mdi-file</v-icon>\r\n\t\t\t\t\t\t\t\t</v-list-item-icon>\r\n\t\t\t\t\t\t\t\t<v-list-item-title class=\"no-overflow\">\r\n\t\t\t\t\t\t\t\t\t{{ file.title }}\r\n\t\t\t\t\t\t\t\t</v-list-item-title>\r\n\t\t\t\t\t\t\t\t<v-list-item-icon v-if=\"canDelete\" @click.stop.prevent=\"deleteFile(file.filename)\">\r\n\t\t\t\t\t\t\t\t\t<v-icon>\r\n\t\t\t\t\t\t\t\t\t\tmdi-delete\r\n\t\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t\t</v-list-item-icon>\r\n\t\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t\t</v-list-item-group>\r\n\t\t\t\t\t</v-list-group>\r\n\t\t\t\t</v-list>\r\n\t\t\t</template>\r\n\t\t</template>\r\n\t\t<template v-else>\r\n\t\t\t<v-alert type=\"info\" class=\"mb-0\">\r\n\t\t\t\tNo Profiles found\r\n\t\t\t</v-alert>\r\n\t\t</template>\r\n\r\n\t\t<v-spacer/>\r\n\r\n\t\t<v-checkbox v-show=\"!individualFiles && estimateEffect\" :input-value=\"showOriginalValues\" @change=\"$emit('update:showOriginalValues', $event)\" label=\"Show original values\" hide-details class=\"ma-3 mb-0\"/>\r\n\t\t<v-checkbox v-show=\"!individualFiles\" v-model=\"estimateEffect\" label=\"Estimate shaper effect\" hide-details class=\"ma-3 mb-0\"/>\r\n\t\t<div :class=\"individualFiles ? 'd-flex' : 'd-none'\" class=\"justify-space-between ma-3 mb-0\">\r\n\t\t\t<v-checkbox :value=\"showSamples\" @change=\"setShowSamples($event)\" label=\"Show samples\" hide-details class=\"mt-0\"/>\r\n\t\t\t<v-btn v-show=\"showSamples\" color=\"primary\" small :disabled=\"selection.length === 0\" @click=\"showSamples = false\">\r\n\t\t\t\t<v-icon class=\"mr-1\" small>mdi-poll</v-icon>\r\n\t\t\t\tAnalyze\r\n\t\t\t</v-btn>\r\n\t\t</div>\r\n\t\t<v-checkbox v-model=\"individualFiles\" label=\"Display individual files\" hide-details class=\"ma-3\"/>\r\n\t</v-card>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport Path from \"@/utils/path\";\r\nimport CSV from \"@/utils/csv\";\r\nimport { analyzeAccelerometerData } from '@duet3d/motionanalysis'\r\n\r\nexport default {\r\n\tprops: {\r\n\t\ttitle: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: String\r\n\t\t},\r\n\t\tfiles: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: Array\r\n\t\t},\r\n\r\n\t\testimateShaperEffect: Boolean,\r\n\t\tshowOriginalValues: Boolean,\r\n\t\tsampleStartIndex: Number,\r\n\t\tsampleEndIndex: Number,\r\n\r\n\t\tcanDelete: Boolean,\r\n\t\tcanShowSamples: Boolean,\r\n\t\twideBand: Boolean,\r\n\r\n\t\tselectedFiles: Array,\r\n\t\tfrequencies: Array,\r\n\t\tvalue: Object,\r\n\t\thadOverflow: Boolean\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['uiFrozen']),\r\n\t\tprofiles() {\r\n\t\t\t// Convert files into profile groups with files\r\n\t\t\tconst profiles = [], uncategorized = [];\r\n\t\t\tfor (let filename of this.files) {\r\n\t\t\t\tconst matches = /^(\\d+)-([a-zA-SU-Z]+)(-?\\d+\\.?\\d*)-(-?\\d+\\.?\\d*)-(\\d+\\.?\\d*)-(\\w+)-?(\\d+\\.?\\d*)?(Hz)?\\.csv/.exec(filename);\r\n\t\t\t\tif (matches) {\r\n\t\t\t\t\tconst title = `Profile #${matches[1]}`;\r\n\t\t\t\t\tlet run = profiles.find(profile => profile.title === title);\r\n\t\t\t\t\tif (!run) {\r\n\t\t\t\t\t\trun = {\r\n\t\t\t\t\t\t\ticon: 'mdi-run',\r\n\t\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\t\tsubtitle: '',\r\n\t\t\t\t\t\t\tfiles: []\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tprofiles.push(run);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst shaperTitle = (matches[6] === 'none') ? 'No Shaping' : ((matches[6] === 'custom') ? 'Custom' : `${matches[6].toUpperCase()} @ ${matches[7]}Hz`);\r\n\t\t\t\t\trun.files.push({\r\n\t\t\t\t\t\ttitle: `${matches[2].split('').reduce((a, b) => `${a}+${b}`)} ${matches[3]}-${matches[4]}, accelerometer ${matches[5]}, ${shaperTitle}`,\r\n\t\t\t\t\t\tfilename,\r\n\t\t\t\t\t\tshaperTitle\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst toolMatches = /^(\\d+)-T(\\d+)-([a-zA-Z]+)(-?\\d+\\.?\\d*)-(-?\\d+\\.?\\d*)-(\\d+\\.?\\d*)-(\\w+)[-]?(\\d+\\.?\\d*)?(Hz)?\\.csv/.exec(filename);\r\n\t\t\t\t\tif (toolMatches) {\r\n\t\t\t\t\t\tconst title = `Profile #${toolMatches[1]}`;\r\n\t\t\t\t\t\tlet run = profiles.find(profile => profile.title === title);\r\n\t\t\t\t\t\tif (!run) {\r\n\t\t\t\t\t\t\trun = {\r\n\t\t\t\t\t\t\t\ticon: 'mdi-run',\r\n\t\t\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\t\t\tsubtitle: '',\r\n\t\t\t\t\t\t\t\tfiles: []\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tprofiles.push(run);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst shaperTitle = (toolMatches[7] === 'none') ? 'No Shaping' : ((toolMatches[7] === 'custom') ? 'Custom' : `${toolMatches[7].toUpperCase()} @ ${toolMatches[8]}Hz`);\r\n\t\t\t\t\t\trun.files.push({\r\n\t\t\t\t\t\t\ttitle: `T${toolMatches[2]}, ${toolMatches[3].split('').reduce((a, b) => `${a}+${b}`)} ${toolMatches[4]}-${toolMatches[5]}, accelerometer ${toolMatches[6]}, ${shaperTitle}`,\r\n\t\t\t\t\t\t\tfilename,\r\n\t\t\t\t\t\t\tshaperTitle\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst filenameMatch = /(.+)\\.csv$/.exec(filename);\r\n\t\t\t\t\t\tif (filenameMatch) {\r\n\t\t\t\t\t\t\tuncategorized.push({\r\n\t\t\t\t\t\t\t\ttitle: filenameMatch[1],\r\n\t\t\t\t\t\t\t\tfilename\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Create the subtitles for each group\r\n\t\t\tfor (let profile of profiles) {\r\n\t\t\t\tconst shaperTitles = profile.files.map(file => file.shaperTitle);\r\n\t\t\t\tif (shaperTitles.length > 0) {\r\n\t\t\t\t\tlet allEqual = true;\r\n\t\t\t\t\tfor (let type of shaperTitles) {\r\n\t\t\t\t\t\tif (type !== shaperTitles[0]) {\r\n\t\t\t\t\t\t\tallEqual = false;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprofile.subtitle = `${allEqual ? shaperTitles[0] : 'Multiple configs'}, ${profile.files.length} moves`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprofile.subtitle = `${profile.files.length} moves`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Add uncategorized files in single-file mode\r\n\t\t\tif (this.individualFiles && uncategorized.length > 0) {\r\n\t\t\t\tprofiles.push({\r\n\t\t\t\t\ticon: 'mdi-file-multiple',\r\n\t\t\t\t\ttitle: 'Uncategorized',\r\n\t\t\t\t\tsubtitle: `${uncategorized.length} files`,\r\n\t\t\t\t\tfiles: uncategorized\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn profiles;\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tselection: [],\r\n\t\t\tprogress: 0,\r\n\t\t\tprogressMax: 0,\r\n\t\t\testimateEffect: false,\r\n\t\t\tindividualFiles: false,\r\n\t\t\tshowSamples: false\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['delete', 'download']),\r\n\t\tasync deleteProfile(profile) {\r\n\t\t\tthis.progress = 0;\r\n\t\t\tthis.progressMax = profile.files.length;\r\n\t\t\ttry {\r\n\t\t\t\tfor (let file of profile.files) {\r\n\t\t\t\t\tawait this.delete(Path.combine(Path.accelerometer, file.filename));\r\n\t\t\t\t\tthis.progress++;\r\n\t\t\t\t}\r\n\t\t\t} finally {\r\n\t\t\t\tthis.progress = this.progressMax = 0;\r\n\t\t\t}\r\n\t\t\tthis.$emit('refresh');\r\n\t\t},\r\n\t\tasync deleteFile(filename) {\r\n\t\t\tthis.progress = 0;\r\n\t\t\tthis.progressMax = 1;\r\n\t\t\ttry {\r\n\t\t\t\tawait this.delete(Path.combine(Path.accelerometer, filename));\r\n\t\t\t} finally {\r\n\t\t\t\tthis.progress = this.progressMax = 0;\r\n\t\t\t}\r\n\t\t\tthis.$emit('refresh');\r\n\t\t},\r\n\t\tsetShowSamples(value) {\r\n\t\t\tif (!value) {\r\n\t\t\t\tthis.sampleStartIndex = this.sampleEndIndex = null;\r\n\t\t\t}\r\n\t\t\tthis.showSamples = value;\r\n\t\t},\r\n\t\tasync getSamples(filename) {\r\n\t\t\t// Download the selected file\r\n\t\t\tconst csvFile = await this.download({\r\n\t\t\t\tfilename: Path.combine(Path.accelerometer, filename),\r\n\t\t\t\ttype: 'text',\r\n\t\t\t\tshowProgress: false,\r\n\t\t\t\tshowSuccess: false,\r\n\t\t\t\tshowError: false\r\n\t\t\t});\r\n\r\n\t\t\t// Load the CSV\r\n\t\t\tconst csv = new CSV(csvFile);\r\n\t\t\tif (csv.headers.length < 4 || csv.headers[0] !== 'Sample' || csv.content.length < 4) {\r\n\t\t\t\tthrow new Error('Invalid accelerometer CSV');\r\n\t\t\t}\r\n\r\n\t\t\t// Extract details\r\n\t\t\tconst details = /Rate (\\d+) overflows (\\d)/.exec(csv.content[csv.content.length - 1].reduce((a, b) => a + b));\r\n\t\t\tif (!details) {\r\n\t\t\t\tthrow new Error('Failed to read rate and overflows');\r\n\t\t\t}\r\n\t\t\tconst samplingRate = parseFloat(details[1]), overflows = parseFloat(details[2]);\r\n\r\n\t\t\t// Report if there were any overflows\r\n\t\t\tif (overflows > 0) {\r\n\t\t\t\tthis.$emit('update:hadOverflow', true);\r\n\t\t\t}\r\n\r\n\t\t\t// Generate result\r\n\t\t\tconst result = {\r\n\t\t\t\tsamplingRate,\r\n\t\t\t\tsamples: Array.from({ length: csv.content[0].length - 1 }, () => [])\r\n\t\t\t};\r\n\r\n\t\t\tfor (let sample = 0; sample < csv.content.length - 1; sample++) {\r\n\t\t\t\tconst sampleValues = csv.content[sample];\r\n\t\t\t\tfor (let axis = 1; axis < sampleValues.length; axis++) {\r\n\t\t\t\t\tresult.samples[axis - 1].push(parseFloat(sampleValues[axis]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tgetFrequencyResponse(datasets) {\r\n\t\t\t// Don't do anything if no samples are given\r\n\t\t\tif (!datasets || datasets.length === 0) {\r\n\t\t\t\treturn {};\r\n\t\t\t}\r\n\r\n\t\t\t// Make sure all the datasets have the same sampling rate and the same count\r\n\t\t\t// FIXME RepRapFirmware provides CSVs with varying sampling rates. For now we use the average rate...\r\n\t\t\tconst samplingRate = (datasets.length > 1) ? datasets.map(dataset => dataset.samplingRate).reduce((a, b) => a + b) / datasets.length : datasets[0].samplingRate;\r\n\t\t\tconst numAxes = datasets[0].samples.length, numSamples = datasets[0].samples[0].length;\r\n\t\t\tfor (let i = 1; i < datasets.length; i++) {\r\n\t\t\t\tif (datasets[i].samples.length !== numAxes) {\r\n\t\t\t\t\tthrow new Error('Datasets must have the same number of axes');\r\n\t\t\t\t}\r\n\t\t\t\tif (datasets[i].samples[0].length !== numSamples) {\r\n\t\t\t\t\tthrow new Error('Datasets must have the same number of samples');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Analyze the datasets and combine the amplitudes\r\n\t\t\tconst firstDataResult = analyzeAccelerometerData(datasets[0].samples, samplingRate, this.wideBand);\r\n\t\t\tconst frequencies = firstDataResult.frequencies, amplitudes = firstDataResult.amplitudes;\r\n\t\t\tfor (let dataset = 1; dataset < datasets.length; dataset++) {\r\n\t\t\t\tconst dataResult = analyzeAccelerometerData(datasets[dataset].samples, samplingRate, this.wideBand);\r\n\t\t\t\tfor (let axis = 0; axis < dataResult.amplitudes.length; axis++) {\r\n\t\t\t\t\tfor (let i = 0; i < dataResult.amplitudes[axis].length; i++) {\r\n\t\t\t\t\t\tamplitudes[axis][i] += dataResult.amplitudes[axis][i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Return the frequencies and mean amplitudes\r\n\t\t\treturn {\r\n\t\t\t\tfrequencies,\r\n\t\t\t\tamplitudes: amplitudes.map(axisValues => axisValues.map(amplitude => amplitude / datasets.length))\r\n\t\t\t};\r\n\t\t},\r\n\t\tasync update() {\r\n\t\t\tthis.$emit('update:hadOverflow', false);\r\n\t\t\tif (this.selection.length > 0) {\r\n\t\t\t\tthis.progress = 0;\r\n\t\t\t\tif (this.individualFiles && this.showSamples) {\r\n\t\t\t\t\tthis.progressMax = 1;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// Get the samples for the first requested file\r\n\t\t\t\t\t\tconst sampleResult = await this.getSamples(this.selection[0]);\r\n\t\t\t\t\t\tthis.$emit('update:selectedFiles', this.selection);\r\n\t\t\t\t\t\tthis.$emit('update:frequencies', null);\r\n\t\t\t\t\t\tthis.$emit('input', {\r\n\t\t\t\t\t\t\tX: sampleResult.samples[0],\r\n\t\t\t\t\t\t\tY: sampleResult.samples[1],\r\n\t\t\t\t\t\t\tZ: sampleResult.samples[2]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} finally {\r\n\t\t\t\t\t\tthis.progress = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.progressMax = this.selection.length + 1;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// Retrieve the samples for each file\r\n\t\t\t\t\t\tconst datasets = [];\r\n\t\t\t\t\t\tfor (let filename of this.selection) {\r\n\t\t\t\t\t\t\tconst samples = await this.getSamples(filename);\r\n\t\t\t\t\t\t\tdatasets.push(samples);\r\n\t\t\t\t\t\t\tthis.progress++;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Limit number of samples if previously selected\r\n\t\t\t\t\t\tif (datasets.length === 1 && typeof this.sampleStartIndex === 'number' && typeof this.sampleEndIndex === 'number') {\r\n\t\t\t\t\t\t\tfor (let axisSamples of datasets[0].samples) {\r\n\t\t\t\t\t\t\t\taxisSamples.splice(this.sampleEndIndex + 1);\r\n\t\t\t\t\t\t\t\taxisSamples.splice(0, this.sampleStartIndex);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Perform FFT on each dataset and get the mean frequency response\r\n\t\t\t\t\t\tconst frequencyResponse = this.getFrequencyResponse(datasets);\r\n\t\t\t\t\t\tthis.$emit('update:selectedFiles', this.selection);\r\n\t\t\t\t\t\tthis.$emit('update:frequencies', frequencyResponse.frequencies);\r\n\t\t\t\t\t\tthis.$emit('input', {\r\n\t\t\t\t\t\t\tX: frequencyResponse.amplitudes[0],\r\n\t\t\t\t\t\t\tY: frequencyResponse.amplitudes[1],\r\n\t\t\t\t\t\t\tZ: frequencyResponse.amplitudes[2]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} finally {\r\n\t\t\t\t\t\tthis.progress = this.progressMax;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.progress = this.progressMax = 0;\r\n\t\t\t\tthis.$emit('update:frequencies', null);\r\n\t\t\t\tif (this.selectedFiles && this.selectedFiles.length > 0) {\r\n\t\t\t\t\t// Update this only if it's still populated, else we get stuck in an endless loop because [] != null\r\n\t\t\t\t\tthis.$emit('update:selectedFiles', []);\r\n\t\t\t\t}\r\n\t\t\t\tthis.$emit('input', null);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tselectedFiles(to) {\r\n\t\t\tthis.selection = to || [];\r\n\t\t},\r\n\t\testimateEffect(to) {\r\n\t\t\tthis.$emit('update:showOriginalValues', !to);\r\n\t\t\tthis.$emit('update:estimateShaperEffect', to);\r\n\t\t},\r\n\t\tindividualFiles(to) {\r\n\t\t\tthis.selection = [];\r\n\t\t\tif (!to) {\r\n\t\t\t\tthis.$emit('update:showOriginalValues', true);\r\n\t\t\t}\r\n\t\t\tthis.$emit('update:useIndividualFiles', to);\r\n\t\t},\r\n\t\tselection() {\r\n\t\t\tthis.update();\r\n\t\t\tthis.$emit('update:sampleStartIndex', null);\r\n\t\t\tthis.$emit('update:sampleEndIndex', null);\r\n\t\t},\r\n\t\tshowSamples(to) {\r\n\t\t\tthis.update();\r\n\t\t\tif (!to) {\r\n\t\t\t\tthis.$emit('update:showOriginalValues', true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>","<style>\r\n.centered-alert > div {\r\n\talign-items: center;\r\n}\r\n.centered-alert > div > div {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-dialog v-model=\"shownInternal\" max-width=\"640px\" no-click-animation>\r\n\t\t<v-card>\r\n\t\t\t<v-card-title>\r\n\t\t\t\t<span class=\"headline\">\r\n\t\t\t\t\tRecord Motion Profile\r\n\t\t\t\t</span>\r\n\t\t\t</v-card-title>\r\n\r\n\t\t\t<v-card-text class=\"pb-0\">\r\n\t\t\t\t<v-window v-model=\"currentPage\">\r\n\t\t\t\t\t<!-- Start -->\r\n\t\t\t\t\t<v-window-item value=\"start\">\r\n\t\t\t\t\t\tThis wizard lets you to collect motion profiles using an accelerometer to tune input shaping.<br>\r\n\r\n\t\t\t\t\t\t<ul class=\"mt-3 mb-4\">\r\n\t\t\t\t\t\t\t<li>Motion Profile #{{ this.run }}</li>\r\n\t\t\t\t\t\t\t<li>Input Shaper: {{ this.shaper }}</li>\r\n\t\t\t\t\t\t\t<li v-show=\"frequency !== null\">Shaper Frequency: {{ frequency }}</li>\r\n\t\t\t\t\t\t\t<li v-show=\"damping !== null\">Damping Factor: {{ damping }}</li>\r\n\t\t\t\t\t\t\t<li v-show=\"amplitudes !== null\">Amplitudes: {{ amplitudes }}</li>\r\n\t\t\t\t\t\t\t<li v-show=\"durations !== null\">Durations: {{ durations }}</li>\r\n\t\t\t\t\t\t</ul>\r\n\r\n\t\t\t\t\t\t<v-alert :value=\"accelerometers.length === 0\" dense text type=\"error\" class=\"my-3\">\r\n\t\t\t\t\t\t\tNo accelerometer found!\r\n\t\t\t\t\t\t\t<a href=\"https://docs.duet3d.com/User_manual/Connecting_hardware/Sensors_Accelerometer\" target=\"_blank\" class=\"float-right\">\r\n\t\t\t\t\t\t\t\tHelp\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</v-alert>\r\n\t\t\t\t\t\t<v-alert :value=\"!allAxesHomed\" border=\"left\" dense text type=\"warning\" class=\"centered-alert my-3\">\r\n\t\t\t\t\t\t\tMachine is not homed\r\n\t\t\t\t\t\t\t<code-btn code=\"G28\" color=\"warning\" small class=\"float-right\">\r\n\t\t\t\t\t\t\t\tHome All\r\n\t\t\t\t\t\t\t</code-btn>\r\n\t\t\t\t\t\t</v-alert>\r\n\t\t\t\t\t\t<v-alert :value=\"(accelerometers.length > 0) && allAxesHomed\" dense text type=\"success\" class=\"my-3\">\r\n\t\t\t\t\t\t\tReady to record data\r\n\t\t\t\t\t\t</v-alert>\r\n\r\n\t\t\t\t\t\t<span v-show=\"(accelerometers.length > 0) && allAxesHomed\">\r\n\t\t\t\t\t\t\tPress Next to continue.\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</v-window-item>\r\n\r\n\t\t\t\t\t<!-- Configuration -->\r\n\t\t\t\t\t<v-window-item value=\"config\">\r\n\t\t\t\t\t\t<div class=\"d-flex flex-column\">\r\n\t\t\t\t\t\t\tHere you can define different moves for the data collection.\r\n\r\n\t\t\t\t\t\t\t<v-simple-table class=\"mt-1\">\r\n\t\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<th class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t\tTool\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\tAccelerometer\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t\tAxis\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th class=\"pr-0\">\r\n\t\t\t\t\t\t\t\t\t\tStart Position\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\t\tEnd Position\r\n\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t<th></th>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t<tr v-for=\"(move, index) in moves\" :key=\"index\">\r\n\t\t\t\t\t\t\t\t\t<td class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t\t<v-select :value=\"move.tool\" @change=\"setMoveTool(move, $event)\" :items=\"toolList\" class=\"pt-0\" hide-details/>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<v-select v-model=\"move.accelerometer\" :items=\"accelerometers\" :rules=\"[val => !!val]\" class=\"pt-0\" hide-details/>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t\t<v-select :value=\"move.axis\" @change=\"setMoveAxis(move, $event)\" :items=\"['X', 'Y', 'X+Y']\" class=\"pt-0\" hide-details/>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td class=\"pr-0\">\r\n\t\t\t\t\t\t\t\t\t\t<v-text-field v-model.number=\"move.start\" type=\"number\" :min=\"getMin(move, true)\" :max=\"getMax(move, true)\" :rules=\"getRules(move, true)\" class=\"pt-0\" hide-details/>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<v-text-field v-model.number=\"move.end\" type=\"number\" :min=\"getMin(move, false)\" :max=\"getMax(move, false)\" :rules=\"getRules(move, false)\" class=\"pt-0\" hide-details/>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t\t<v-btn color=\"warning\" outlined :disabled=\"moves.length <= 1\" @click=\"removeMove(index)\">\r\n\t\t\t\t\t\t\t\t\t\t\t<v-icon>mdi-delete</v-icon>\r\n\t\t\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t</v-simple-table>\r\n\t\t\t\t\t\t\t<v-divider class=\"mb-3\"/>\r\n\r\n\t\t\t\t\t\t\t<v-btn color=\"blue darken-1\" class=\"mx-auto\" outlined text @click=\"addMove\">\r\n\t\t\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-plus</v-icon>\r\n\t\t\t\t\t\t\t\tAdd Move\r\n\t\t\t\t\t\t\t</v-btn>\r\n\r\n\t\t\t\t\t\t\t<v-alert :value=\"hasExternalAccelerometers\" type=\"info\" dense class=\"mt-3\">\r\n\t\t\t\t\t\t\t\tThis machine appears to have expansion boards with embedded accelerometers. If you are operating a tool changer, it is recommended to set the corresponding tool for each accelerometer.\r\n\t\t\t\t\t\t\t</v-alert>\r\n\r\n\t\t\t\t\t\t\t<v-checkbox class=\"my-2\" v-model=\"centerAxes\" label=\"Centre unused axes before each move\" :ripple=\"false\" hide-details/>\r\n\t\t\t\t\t\t\t<div v-show=\"centerAxes\" class=\"mx-9\">\r\n\t\t\t\t\t\t\t\t<div class=\"d-inline-flex\">\r\n\t\t\t\t\t\t\t\t\t<v-text-field type=\"number\" v-model.number=\"xAxisCenter\" label=\"X axis centre position\" :min=\"xAxis.min\" :max=\"xAxis.max\" step=\"1\" :rules=\"[(val) => !isNaN(val) && val >= xAxis.min && val <= xAxis.max]\"/>\r\n\t\t\t\t\t\t\t\t\t<v-text-field type=\"number\" class=\"ml-5\" v-model.number=\"yAxisCenter\" label=\"Y axis centre position\" :min=\"xAxis.min\" :max=\"xAxis.max\" step=\"1\" :rules=\"[(val) => !isNaN(val) && val >= yAxis.min && val <= yAxis.max]\"/>\r\n\t\t\t\t\t\t\t\t\t<v-text-field v-show=\"showZCenter\" type=\"number\" class=\"ml-5\" v-model.number=\"zAxisCenter\" label=\"Z axis centre position\" :rules=\"[(val) => !isNaN(val) && val >= zAxis.min && val <= zAxis.max]\"/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<v-checkbox class=\"my-2\" v-model=\"recordWholeMove\" label=\"Capture data during the whole length of the move\" :ripple=\"false\" hide-details/>\r\n\r\n\t\t\t\t\t\t\tThe machine will record a new Motion Profile as soon as Next is clicked.\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</v-window-item>\r\n\r\n\t\t\t\t\t<!-- Data Collection -->\r\n\t\t\t\t\t<v-window-item value=\"collection\">\r\n\t\t\t\t\t\t<span v-show=\"!finished\">\r\n\t\t\t\t\t\t\tPlease stand by while Motion Profiles are being recorded...\r\n\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t<v-simple-table class=\"mt-1\">\r\n\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<th class=\"px-0\"></th>\r\n\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\tTool\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t<th class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\tAccelerometer\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\tAxis\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t<th class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\tStart Position\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t<th>\r\n\t\t\t\t\t\t\t\t\tEnd Position\r\n\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t<tr v-for=\"(move, index) in moves\" :key=\"index\">\r\n\t\t\t\t\t\t\t\t<td class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t<v-icon>\r\n\t\t\t\t\t\t\t\t\t\t{{ getMoveIcon(move) }}\r\n\t\t\t\t\t\t\t\t\t</v-icon>\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t{{ move.tool ? (move.tool.name || `T${move.tool.number}`) : 'None' }}\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t<td class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t{{ getAccelerometerId(move.accelerometer) }}\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t{{ move.axis }}\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t<td class=\"px-0\">\r\n\t\t\t\t\t\t\t\t\t{{ move.start }}\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t{{ move.end }}\r\n\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t</v-simple-table>\r\n\t\t\t\t\t\t<v-divider/>\r\n\r\n\t\t\t\t\t\t<v-alert :value=\"cancelled\" dense text type=\"error\" class=\"mt-3\">\r\n\t\t\t\t\t\t\tData collection cancelled!\r\n\t\t\t\t\t\t</v-alert>\r\n\t\t\t\t\t\t<v-alert :value=\"finished\" dense text type=\"success\" class=\"mt-3\">\r\n\t\t\t\t\t\t\tRecording of Motion Profile #{{ this.run }} is complete!\r\n\t\t\t\t\t\t</v-alert>\r\n\t\t\t\t\t</v-window-item>\r\n\t\t\t\t</v-window>\r\n\t\t\t</v-card-text>\r\n\r\n\t\t\t<v-card-actions>\r\n\t\t\t\t<v-btn v-show=\"!cancelled && !finished\" color=\"blue darken-1\" text @click=\"cancel\">\r\n\t\t\t\t\tCancel\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-spacer/>\r\n\t\t\t\t<v-btn v-show=\"canGoBack\" color=\"blue darken-1\" text @click=\"goBack\">\r\n\t\t\t\t\tBack\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-btn v-show=\"currentPage !== 'collection'\" color=\"blue darken-1\" text :disabled=\"!canGoNext\" @click=\"goNext\">\r\n\t\t\t\t\tNext\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-btn v-show=\"cancelled || finished\" color=\"blue darken-1\" text @click=\"shownInternal = false\">\r\n\t\t\t\t\tFinish\r\n\t\t\t\t</v-btn>\r\n\t\t\t</v-card-actions>\r\n\t\t</v-card>\r\n\t</v-dialog>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapActions, mapState } from 'vuex'\r\n\r\nimport { Axis } from '@/store/machine/modelItems'\r\nimport { OperationCancelledError } from '@/utils/errors'\r\nimport { KinematicsName, StatusType } from \"@/store/machine/modelEnums\";\r\n\r\nconst MoveState = {\r\n\tidle: 'idle',\r\n\trecording: 'recording',\r\n\tfinished: 'finished',\r\n\tcancelled: 'cancelled'\r\n}\r\n\r\nexport default {\r\n\tprops: {\r\n\t\tlastRun: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: Number\r\n\t\t},\r\n\t\tshown: {\r\n\t\t\trequired: true,\r\n\t\t\ttype: Boolean\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState('machine/model', ['boards', 'move', 'tools', 'state']),\r\n\t\txAxis() { return this.move.axes.find(axis => axis.letter === 'X') || new Axis(); },\r\n\t\tyAxis() { return this.move.axes.find(axis => axis.letter === 'Y') || new Axis(); },\r\n\t\tzAxis() { return this.move.axes.find(axis => axis.letter === 'Z') || new Axis(); },\r\n\t\tshownInternal: {\r\n\t\t\tget() { return this.shown },\r\n\t\t\tset(value) { this.$emit('update:shown', value); }\r\n\t\t},\r\n\t\tshaper() {\r\n\t\t\tif (this.move.shaping.type === 'none') {\r\n\t\t\t\treturn 'None';\r\n\t\t\t}\r\n\t\t\tif (this.move.shaping.type === 'custom') {\r\n\t\t\t\treturn 'Custom';\r\n\t\t\t}\r\n\t\t\treturn this.move.shaping.type.toUpperCase();\r\n\t\t},\r\n\t\tfrequency() {\r\n\t\t\treturn (this.move.shaping.type === 'none' || this.move.shaping.type === 'custom') ? null : `${this.move.shaping.frequency}Hz`;\r\n\t\t},\r\n\t\tdamping() {\r\n\t\t\treturn (this.move.shaping.type === 'none' || this.move.shaping.type === 'custom') ? null : this.move.shaping.damping.toString();\r\n\t\t},\r\n\t\tamplitudes() {\r\n\t\t\treturn (this.move.shaping.type === 'custom') ? this.move.shaping.amplitudes.map(amplitude => amplitude.toString()).reduce((a, b) => a + ', ' + b) : null;\r\n\t\t},\r\n\t\tdurations() {\r\n\t\t\treturn (this.move.shaping.type === 'custom') ? this.move.shaping.durations.map(duration => (duration / 1000).toFixed(3) + 'ms').reduce((a, b) => a + ', ' + b) : null;\r\n\t\t},\r\n\t\tallAxesHomed() { return !this.move.axes.some(axis => !axis.homed); },\r\n\t\taccelerometers() {\r\n\t\t\treturn this.boards\r\n\t\t\t\t.filter(board => board.accelerometer !== null)\r\n\t\t\t\t.map(board => ({\r\n\t\t\t\t\ttext: board.canAddress ? `${board.canAddress}.0` : '0',\r\n\t\t\t\t\tvalue: board.accelerometer\r\n\t\t\t\t}));\r\n\t\t},\r\n\t\thasExternalAccelerometers() {\r\n\t\t\treturn this.boards.some(board => (board.canAddress !== 0) && !!board.accelerometer);\r\n\t\t},\r\n\t\ttoolList() {\r\n\t\t\treturn [{ text: 'None', value: null }].concat(this.tools\r\n\t\t\t\t.map(tool => ({\r\n\t\t\t\t\ttext: tool.name || tool.number.toString(),\r\n\t\t\t\t\tvalue: tool\r\n\t\t\t\t})));\r\n\t\t},\r\n\t\tshowZCenter() {\r\n\t\t\treturn [KinematicsName.delta, KinematicsName.rotaryDelta, KinematicsName.coreXZ].includes(this.move.kinematics.name);\r\n\t\t},\r\n\t\tmaxSpeed() {\r\n\t\t\tlet maxSpeed = 6000;\r\n\t\t\tfor (let axis of this.move.axes) {\r\n\t\t\t\tif (axis.speed > maxSpeed) {\r\n\t\t\t\t\tmaxSpeed = axis.speed;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this.moves.some(move => move.axis.length > 1) ? Math.round(maxSpeed * Math.sqrt(2)) : maxSpeed;\r\n\t\t},\r\n\t\tcanGoBack() {\r\n\t\t\treturn this.currentPage === 'config';\r\n\t\t},\r\n\t\tcanGoNext() {\r\n\t\t\tswitch (this.currentPage) {\r\n\t\t\t\tcase 'start': return (this.accelerometers.length > 0) && this.allAxesHomed;\r\n\t\t\t\tcase 'config':\r\n\t\t\t\t\tfor (let move of this.moves) {\r\n\t\t\t\t\t\tif (!move.accelerometer || !move.axis || move.start >= move.end ||\r\n\t\t\t\t\t\t\tmove.start < this.getMin(move, true) || move.start > this.getMax(move, true) ||\r\n\t\t\t\t\t\t\tmove.end < this.getMin(move, false) || move.end > this.getMax(move, false)) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn (this.moves.length > 0) && (!this.centerAxes || (\r\n\t\t\t\t\t\t!isNaN(this.xAxisCenter) && this.xAxisCenter >= this.xAxis.min && this.xAxisCenter < this.xAxis.max &&\r\n\t\t\t\t\t\t!isNaN(this.yAxisCenter) && this.yAxisCenter >= this.yAxis.min && this.yAxisCenter < this.yAxis.max &&\r\n\t\t\t\t\t\t((!isNaN(this.zAxisCenter) && this.zAxisCenter >= this.zAxis.min && this.zAxisCenter < this.zAxis.max) || !this.showZCenter)));\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcurrentPage: 'start',\r\n\t\t\tmoves: [],\r\n\t\t\tcenterAxes: true,\r\n\t\t\txAxisCenter: 0,\r\n\t\t\tyAxisCenter: 0,\r\n\t\t\tzAxisCenter: 0,\r\n\t\t\trecordWholeMove: true,\r\n\t\t\trun: 0,\r\n\t\t\tfinished: false,\r\n\t\t\tcancelled: false\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['sendCode']),\r\n\t\trefreshCenters() {\r\n\t\t\tif (this.currentPage === 'collection') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.xAxisCenter = (this.xAxis.min + this.xAxis.max) / 2;\r\n\t\t\tthis.yAxisCenter = (this.yAxis.min + this.yAxis.max) / 2;\r\n\t\t\tthis.zAxisCenter = (this.zAxis.min + this.zAxis.max) / 2;\r\n\t\t},\r\n\t\tmakeMoves() {\r\n\t\t\tif (this.currentPage === 'collection') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.moves = this.move.axes\r\n\t\t\t\t.filter(axis => axis.letter === 'X' || axis.letter === 'Y')\r\n\t\t\t\t.map(axis => ({\r\n\t\t\t\t\tstate: MoveState.idle,\r\n\t\t\t\t\ttool: null,\r\n\t\t\t\t\taccelerometer: (this.accelerometers.length > 0) ? this.accelerometers[0].value : null,\r\n\t\t\t\t\taxis: axis.letter,\r\n\t\t\t\t\tstart: Math.round((axis.min + axis.max) / 2 - (axis.max - axis.min) / 4),\r\n\t\t\t\t\tend: Math.round((axis.min + axis.max) / 2 + (axis.max - axis.min) / 4),\r\n\t\t\t\t}));\r\n\t\t},\r\n\t\taddMove() {\r\n\t\t\tconst xAxis = this.move.axes.find(axis => axis.letter === 'X');\r\n\t\t\tthis.moves.push({\r\n\t\t\t\tstate: MoveState.idle,\r\n\t\t\t\ttool: null,\r\n\t\t\t\taccelerometer: (this.accelerometers.length > 0) ? this.accelerometers[0].value : null,\r\n\t\t\t\taxis: 'X',\r\n\t\t\t\tstart: xAxis ? Math.round((xAxis.min + xAxis.max) / 2 - (xAxis.max - xAxis.min) / 4) : null,\r\n\t\t\t\tend: xAxis ? Math.round((xAxis.min + xAxis.max) / 2 + (xAxis.max - xAxis.min) / 4) : null\r\n\t\t\t});\r\n\t\t},\r\n\t\tsetMoveTool(move, tool) {\r\n\t\t\tconst axisIndex = this.move.axes.findIndex(axis => axis.letter === move.axis);\r\n\t\t\tif (axisIndex >= 0) {\r\n\t\t\t\tif (move.tool) {\r\n\t\t\t\t\t// Subtract old tool offset\r\n\t\t\t\t\tmove.start -= move.tool.offsets[axisIndex];\r\n\t\t\t\t\tmove.end -= move.tool.offsets[axisIndex];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tool) {\r\n\t\t\t\t\t// Add new tool offset\r\n\t\t\t\t\tmove.start += tool.offsets[axisIndex];\r\n\t\t\t\t\tmove.end += tool.offsets[axisIndex];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmove.tool = tool;\r\n\t\t},\r\n\t\tsetMoveAxis(move, axis) {\r\n\t\t\tconst axisObj = this.move.axes.find(obj => obj.letter === axis);\r\n\t\t\tif (axisObj) {\r\n\t\t\t\tconst axisIndex = this.move.axes.findIndex(item => item.letter === axis);\r\n\t\t\t\tmove.start = Math.round((axis.min + axis.max) / 2 - (axis.max - axis.min) / 4);\r\n\t\t\t\tmove.end = Math.round((axis.min + axis.max) / 2 + (axis.max - axis.min) / 4);\r\n\t\t\t\tif (move.tool) {\r\n\t\t\t\t\tmove.start += move.tool.offsets[axisIndex];\r\n\t\t\t\t\tmove.end += move.tool.offsets[axisIndex];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmove.axis = axis;\r\n\t\t},\r\n\t\tremoveMove(index) {\r\n\t\t\tthis.moves.splice(index, 1);\r\n\t\t},\r\n\t\tgetMin(move, start) {\r\n\t\t\tif (!move.axis) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tlet min = null, axes = move.axis.split('+');\r\n\t\t\tfor (let axis of this.move.axes) {\r\n\t\t\t\tif (axes.includes(axis.letter) && (min === null || min < axis.min)) {\r\n\t\t\t\t\tif (move.tool !== null) {\r\n\t\t\t\t\t\tswitch (axis.letter) {\r\n\t\t\t\t\t\t\tcase 'X':\r\n\t\t\t\t\t\t\t\tmin = axis.min + move.tool.offsets[0];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\t\t\tmin = axis.min + move.tool.offsets[1];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmin = axis.min;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn start ? min : Math.max(min, move.start ?? min);\r\n\t\t},\r\n\t\tgetMax(move, start) {\r\n\t\t\tif (!move.axis) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tlet max = null, axes = move.axis.split('+');\r\n\t\t\tfor (let axis of this.move.axes) {\r\n\t\t\t\tif (axes.includes(axis.letter) && (max === null || max > axis.max)) {\r\n\t\t\t\t\tif (move.tool !== null) {\r\n\t\t\t\t\t\tswitch (axis.letter) {\r\n\t\t\t\t\t\t\tcase 'X':\r\n\t\t\t\t\t\t\t\tmax = axis.max + move.tool.offsets[0];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\t\t\tmax = axis.max + move.tool.offsets[1];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmax = axis.max;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn start ? Math.min(max, move.end ?? max) : max;\r\n\t\t},\r\n\t\tgetRules(move, start) {\r\n\t\t\treturn [\r\n\t\t\t\tval => val >= this.getMin(move, start),\r\n\t\t\t\tval => val <= this.getMax(move, start)\r\n\t\t\t];\r\n\t\t},\r\n\t\tgetAccelerometerId(accelerometer) {\r\n\t\t\tif (!accelerometer) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tconst item = this.accelerometers.find(item => item.value === accelerometer);\r\n\t\t\treturn item ? item.text : null;\r\n\t\t},\r\n\t\tasync doCode(code) {\r\n\t\t\tconst reply = await this.sendCode(code);\r\n\t\t\tif (reply.indexOf('Error') === 0) {\r\n\t\t\t\tthrow new Error(`Code ${code} failed: ${reply}`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetMoveFilename(move, accelerometerId) {\r\n\t\t\tlet filename = this.run.toString();\r\n\t\t\tif (move.tool) {\r\n\t\t\t\tfilename += '-T' + move.tool.number;\r\n\t\t\t}\r\n\t\t\tfilename += `-${move.axis.replace(/\\+/g, '')}${move.start}-${move.end}-${accelerometerId}-${this.move.shaping.type}`;\r\n\t\t\tif (this.move.shaping.type !== 'none' && this.move.shaping.type !== 'custom') {\r\n\t\t\t\tfilename += `-${this.move.shaping.frequency}Hz`;\r\n\t\t\t}\r\n\t\t\tfilename += '.csv';\r\n\t\t\treturn filename;\r\n\t\t},\r\n\t\tasync waitForAccelerometerRun(accelerometer) {\r\n\t\t\tif (this.cancelled) {\r\n\t\t\t\tthrow new OperationCancelledError();\r\n\t\t\t}\r\n\r\n\t\t\tlet resolve, reject;\r\n\t\t\tconst promise = new Promise((res, rej) => { resolve = res; reject = rej; });\r\n\t\t\tconst unwatch = this.$watch(() => accelerometer.runs || this.cancelled, () => {\r\n\t\t\t\tif (this.cancelled) {\r\n\t\t\t\t\treject();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t\tunwatch();\r\n\t\t\t});\r\n\t\t\treturn promise;\r\n\t\t},\r\n\t\tasync recordMove(moveIndex, hadSelectedTool = false) {\r\n\t\t\tconst move = this.moves[moveIndex];\r\n\t\t\tmove.state = MoveState.recording;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Deal with tool selections\r\n\t\t\t\tif (move.tool) {\r\n\t\t\t\t\tawait this.doCode(`T${move.tool.number}`);\r\n\t\t\t\t\thadSelectedTool = true;\r\n\t\t\t\t} else if (hadSelectedTool) {\r\n\t\t\t\t\tawait this.doCode('T-1');\r\n\t\t\t\t\thadSelectedTool = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.cancelled) {\r\n\t\t\t\t\tmove.state = MoveState.cancelled;\r\n\t\t\t\t\tthrow new OperationCancelledError();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Go to the start position\r\n\t\t\t\tconst moveAxes = move.axis.split('+');\r\n\t\t\t\tlet startMoveParameters = moveAxes.map(axis => `${axis}${move.start}`).reduce((a, b) => a + ' ' + b);\r\n\t\t\t\tif (this.centerAxes) {\r\n\t\t\t\t\tif (!moveAxes.includes('X')) {\r\n\t\t\t\t\t\tstartMoveParameters += move.tool ? ` X${this.xAxisCenter + move.tool.offsets[0]}` : ` X${this.xAxisCenter}`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!moveAxes.includes('Y')) {\r\n\t\t\t\t\t\tstartMoveParameters += move.tool ? ` Y${this.yAxisCenter + move.tool.offsets[1]}` : ` Y${this.yAxisCenter}`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.showZCenter) {\r\n\t\t\t\t\t\tstartMoveParameters += move.tool ? ` Z${this.zAxisCenter + move.tool.offsets[2]}` : ` Z${this.zAxisCenter}`\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tawait this.doCode(`G1 ${startMoveParameters} F${this.maxSpeed}`);\r\n\t\t\t\tawait this.doCode('G4 S1');\r\n\t\t\t\tif (this.cancelled) {\r\n\t\t\t\t\tmove.state = MoveState.cancelled;\r\n\t\t\t\t\tthrow new OperationCancelledError();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Start sampling and move on to the end position\r\n\t\t\t\tconst endMoveParameters = move.axis.split('+').map(axis => `${axis}${move.end}`).reduce((a, b) => a + ' ' + b);\r\n\t\t\t\tconst accelerometerId = this.getAccelerometerId(move.accelerometer);\r\n\t\t\t\tif (this.recordWholeMove) {\r\n\t\t\t\t\tawait this.doCode(`M400 M956 P${accelerometerId} S1000 A0 F\"${this.getMoveFilename(move, accelerometerId)}\" G1 ${endMoveParameters} F${this.maxSpeed}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tawait this.doCode(`G1 ${endMoveParameters} F${this.maxSpeed} M400 M956 P${accelerometerId} S1000 A0 F\"${this.getMoveFilename(move, accelerometerId)}\"`);\r\n\t\t\t\t}\r\n\t\t\t\tawait this.waitForAccelerometerRun(move.accelerometer);\r\n\r\n\t\t\t\t// Done, move on to the next move\r\n\t\t\t\tmove.state = MoveState.finished;\r\n\t\t\t\tif (moveIndex + 1 < this.moves.length) {\r\n\t\t\t\t\t// Start the next move\r\n\t\t\t\t\tawait this.recordMove(moveIndex + 1, hadSelectedTool);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Sampling complete\r\n\t\t\t\t\tif (!this.cancelled) {\r\n\t\t\t\t\t\tthis.$emit('finished');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.finished = true;\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.warn(`Sampling cancelled at move #${moveIndex}: ${e.message || e}`);\r\n\t\t\t\tmove.state = MoveState.cancelled;\r\n\t\t\t\tthis.cancelled = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetMoveIcon(move) {\r\n\t\t\tswitch (move.state) {\r\n\t\t\t\tcase MoveState.idle: return 'mdi-asterisk';\r\n\t\t\t\tcase MoveState.recording: return 'mdi-play';\r\n\t\t\t\tcase MoveState.finished: return 'mdi-check';\r\n\t\t\t\tcase MoveState.cancelled: return 'mdi-close';\r\n\t\t\t}\r\n\t\t\treturn 'mdi-help-circle-outline';\r\n\t\t},\r\n\t\tcancel() {\r\n\t\t\tif (this.currentPage === 'collection' && !this.cancelled) {\r\n\t\t\t\tthis.cancelled = this.finished = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.shownInternal = false\r\n\t\t\t}\r\n\t\t},\r\n\t\tgoBack() {\r\n\t\t\tswitch (this.currentPage) {\r\n\t\t\t\tcase 'config':\r\n\t\t\t\t\tthis.currentPage = 'start';\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgoNext() {\r\n\t\t\tswitch (this.currentPage) {\r\n\t\t\t\tcase 'start':\r\n\t\t\t\t\tthis.moves.forEach(move => move.state = MoveState.idle);\r\n\t\t\t\t\tthis.currentPage = 'config';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'config':\r\n\t\t\t\t\tthis.currentPage = 'collection';\r\n\t\t\t\t\tthis.cancelled = false;\r\n\t\t\t\t\tthis.recordMove(0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.run = this.lastRun + 1;\r\n\t\tthis.refreshCenters();\r\n\t\tthis.makeMoves();\r\n\t},\r\n\twatch: {\r\n\t\taccelerometers() { this.makeMoves(); },\r\n\t\t'xAxis.min'() { this.makeMoves(); this.refreshCenters(); },\r\n\t\t'xAxis.max'() { this.makeMoves(); this.refreshCenters(); },\r\n\t\t'yAxis.min'() { this.makeMoves(); this.refreshCenters(); },\r\n\t\t'yAxis.max'() { this.makeMoves(); this.refreshCenters(); },\r\n\t\t'zAxis.min'() { this.refreshCenters(); },\r\n\t\t'zAxis.max'() { this.refreshCenters(); },\r\n\t\tshown(to) {\r\n\t\t\tif (to){\r\n\t\t\t\tthis.run = this.lastRun + 1;\r\n\t\t\t} else {\r\n\t\t\t\tif (this.currentPage === 'collection') {\r\n\t\t\t\t\t// This will interrupt the current sampling\r\n\t\t\t\t\tthis.cancelled = true;\r\n\t\t\t\t}\r\n\t\t\t\tthis.currentPage = 'start';\r\n\t\t\t\tthis.cancelled = this.finished = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t'state.status'(to) {\r\n\t\t\tif ((to === StatusType.disconnected || to === StatusType.off) && this.currentPage === 'collection') {\r\n\t\t\t\tthis.cancelled = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-checkbox',{attrs:{\"input-value\":(_vm.value === 'none') ? (_vm.shapingType === 'none') : _vm.inputValue,\"value\":(_vm.value === 'none') ? true : _vm.value,\"disabled\":_vm.uiFrozen,\"label\":_vm.label,\"hide-details\":\"\"},on:{\"change\":_vm.change},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_vm._t(\"default\",function(){return [_c('v-chip',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.current === _vm.value),expression:\"current === value\"}],attrs:{\"small\":\"\",\"color\":\"success\"}},[_vm._v(\" configured \")]),_c('v-chip',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showApply),expression:\"showApply\"}],attrs:{\"small\":\"\",\"color\":\"gray\"},on:{\"click\":_vm.apply}},[_vm._v(\" apply \")])]})]},proxy:true}],null,true)})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-row',[_c('v-col',[_c('v-card',[_c('v-tabs',{model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},[_c('v-tab',{attrs:{\"href\":\"#current\"}},[_c('v-icon',{staticClass:\"mr-1\"},[_vm._v(\"mdi-information\")]),_vm._v(\" Current Settings \")],1),_c('v-tab',{attrs:{\"href\":\"#analysis\"}},[_c('v-icon',{staticClass:\"mr-1\"},[_vm._v(\"mdi-file\")]),_vm._v(\" Motion Analysis \")],1),_c('v-btn',{staticClass:\"align-self-center ml-auto mr-2 hidden-sm-and-down\",attrs:{\"color\":\"success\",\"disabled\":_vm.uiFrozen},on:{\"click\":function($event){_vm.showDataCollection = true}}},[_c('v-icon',{staticClass:\"mr-1\"},[_vm._v(\"mdi-record\")]),_vm._v(\" Record Motion Profile \")],1)],1),_c('v-tabs-items',{model:{value:(_vm.tab),callback:function ($$v) {_vm.tab=$$v},expression:\"tab\"}},[_c('v-tab-item',{attrs:{\"value\":\"current\"}},[_c('div',{staticClass:\"d-flex flex-column\"},[_c('v-alert',{staticClass:\"mb-0\",attrs:{\"value\":!_vm.isInputShapingEnabled,\"type\":\"info\"}},[_vm._v(\" Input Shaping is not configured. Record a new Motion Profile to set it up \")]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isInputShapingEnabled),expression:\"isInputShapingEnabled\"}],staticClass:\"content flex-grow-1 pa-2\"},[_c('input-shaping-chart',{attrs:{\"frequencies\":_vm.currentFrequencies,\"ringing-frequency\":_vm.frequency,\"input-shapers\":_vm.inputShapers,\"input-shaper-frequency\":_vm.frequency,\"input-shaper-damping\":_vm.damping,\"custom-amplitudes\":_vm.customAmplitudes,\"custom-durations\":_vm.customDurations}})],1)],1)]),_c('v-tab-item',{attrs:{\"value\":\"analysis\"}},[_c('div',{staticClass:\"d-flex flex-column\"},[_c('v-progress-linear',{attrs:{\"active\":_vm.loadingFiles,\"indeterminate\":\"\"}}),_c('v-alert',{staticClass:\"mb-0\",attrs:{\"value\":_vm.files.length === 0 && !_vm.filesError,\"type\":\"info\"}},[_vm._v(\" No Motion Profiles found. Record a new Motion Profile or \"),_c('a',{staticClass:\"white--text text-decoration-underline\",attrs:{\"href\":\"javascript:void(0)\"},on:{\"click\":_vm.refresh}},[_vm._v(\"refresh\")]),_vm._v(\" the file list \")]),_c('v-alert',{staticClass:\"mb-0\",attrs:{\"value\":_vm.filesError,\"type\":\"error\"}},[_vm._v(\" \"+_vm._s(_vm.filesError)+\" \")]),_c('v-row',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.files.length > 0),expression:\"files.length > 0\"}],staticClass:\"content pa-2\"},[_c('v-col',{staticClass:\"d-flex pa-0\",attrs:{\"cols\":\"auto\"}},[_c('input-shaping-file-list',{attrs:{\"title\":\"Motion Profiles\",\"can-delete\":\"\",\"files\":_vm.files,\"selectedFiles\":_vm.filesToAnalyze,\"frequencies\":_vm.fileFrequenciesToAnalyze,\"sample-start-index\":_vm.sampleStartIndex,\"sample-end-index\":_vm.sampleEndIndex,\"had-overflow\":_vm.hadOverflow,\"estimate-shaper-effect\":_vm.estimateShaperEffect,\"show-original-values\":_vm.showOriginalValues},on:{\"refresh\":_vm.refresh,\"update:selectedFiles\":function($event){_vm.filesToAnalyze=$event},\"update:selected-files\":function($event){_vm.filesToAnalyze=$event},\"update:frequencies\":function($event){_vm.fileFrequenciesToAnalyze=$event},\"update:sampleStartIndex\":function($event){_vm.sampleStartIndex=$event},\"update:sample-start-index\":function($event){_vm.sampleStartIndex=$event},\"update:sampleEndIndex\":function($event){_vm.sampleEndIndex=$event},\"update:sample-end-index\":function($event){_vm.sampleEndIndex=$event},\"update:hadOverflow\":function($event){_vm.hadOverflow=$event},\"update:had-overflow\":function($event){_vm.hadOverflow=$event},\"update:estimateShaperEffect\":function($event){_vm.estimateShaperEffect=$event},\"update:estimate-shaper-effect\":function($event){_vm.estimateShaperEffect=$event},\"update:showOriginalValues\":function($event){_vm.showOriginalValues=$event},\"update:show-original-values\":function($event){_vm.showOriginalValues=$event}},model:{value:(_vm.fileDataToAnalyze),callback:function ($$v) {_vm.fileDataToAnalyze=$$v},expression:\"fileDataToAnalyze\"}})],1),_c('v-col',{staticClass:\"align-center justify-center\",class:!!_vm.filesToAnalyze.length ? 'd-none' : 'd-flex'},[_vm._v(\" Please select a Motion Profile \")]),_c('v-col',{directives:[{name:\"show\",rawName:\"v-show\",value:(!!_vm.filesToAnalyze.length),expression:\"!!filesToAnalyze.length\"}],staticClass:\"flex-column pa-0\",class:!!_vm.filesToAnalyze.length ? 'd-flex' : 'd-none'},[_c('v-alert',{staticClass:\"mb-0\",attrs:{\"value\":_vm.hadOverflow,\"type\":\"warning\"}},[_vm._v(\" The selected motion profile contains overflows. It may not be accurate. \")]),_c('v-card',{staticClass:\"d-block fill-height pa-2\",attrs:{\"outlined\":\"\"}},[_c('input-shaping-chart',{attrs:{\"can-show-samples\":\"\",\"sample-start-index\":_vm.sampleStartIndex,\"sample-end-index\":_vm.sampleEndIndex,\"frequencies\":_vm.fileFrequenciesToAnalyze,\"value\":_vm.fileDataToAnalyze,\"ringing-frequency\":_vm.frequency,\"input-shapers\":_vm.inputShapers,\"input-shaper-frequency\":_vm.frequency,\"input-shaper-damping\":_vm.damping,\"custom-amplitudes\":_vm.customAmplitudes,\"custom-durations\":_vm.customDurations,\"estimate-shaper-effect\":_vm.estimateShaperEffect,\"show-values\":_vm.showOriginalValues},on:{\"update:sampleStartIndex\":function($event){_vm.sampleStartIndex=$event},\"update:sample-start-index\":function($event){_vm.sampleStartIndex=$event},\"update:sampleEndIndex\":function($event){_vm.sampleEndIndex=$event},\"update:sample-end-index\":function($event){_vm.sampleEndIndex=$event}}})],1)],1)],1)],1)])],1)],1)],1),_c('v-col',{attrs:{\"cols\":\"auto\"}},[_c('v-card',{attrs:{\"tile\":\"\"}},[_c('v-card-title',{staticClass:\"pb-2\"},[_c('v-icon',{staticClass:\"mr-1\"},[_vm._v(\"mdi-transition\")]),_vm._v(\" Input Shapers \")],1),_c('v-card-text',{staticClass:\"d-flex flex-column\"},[_c('input-shaper-checkbox',{staticClass:\"mt-0\",attrs:{\"value\":\"none\",\"current\":_vm.shaping.type},model:{value:(_vm.inputShapers),callback:function ($$v) {_vm.inputShapers=$$v},expression:\"inputShapers\"}}),_c('input-shaper-checkbox',{attrs:{\"value\":\"mzv\",\"current\":_vm.shaping.type},model:{value:(_vm.inputShapers),callback:function ($$v) {_vm.inputShapers=$$v},expression:\"inputShapers\"}}),_c('input-shaper-checkbox',{attrs:{\"value\":\"zvd\",\"current\":_vm.shaping.type},model:{value:(_vm.inputShapers),callback:function ($$v) {_vm.inputShapers=$$v},expression:\"inputShapers\"}}),_c('input-shaper-checkbox',{attrs:{\"value\":\"zvdd\",\"current\":_vm.shaping.type},model:{value:(_vm.inputShapers),callback:function ($$v) {_vm.inputShapers=$$v},expression:\"inputShapers\"}}),_c('input-shaper-checkbox',{attrs:{\"value\":\"zvddd\",\"current\":_vm.shaping.type},model:{value:(_vm.inputShapers),callback:function ($$v) {_vm.inputShapers=$$v},expression:\"inputShapers\"}}),_c('input-shaper-checkbox',{attrs:{\"value\":\"ei2\",\"current\":_vm.shaping.type},model:{value:(_vm.inputShapers),callback:function ($$v) {_vm.inputShapers=$$v},expression:\"inputShapers\"}}),_c('input-shaper-checkbox',{attrs:{\"value\":\"ei3\",\"current\":_vm.shaping.type},model:{value:(_vm.inputShapers),callback:function ($$v) {_vm.inputShapers=$$v},expression:\"inputShapers\"}}),_c('v-divider',{staticClass:\"mt-3\"}),_c('v-text-field',{staticClass:\"mt-3\",attrs:{\"type\":\"number\",\"min\":\"10\",\"step\":\"1\",\"max\":\"1000\",\"disabled\":_vm.uiFrozen,\"label\":\"Shaper centre frequency\",\"hide-details\":\"\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.preventDefault();return _vm.setFrequency.apply(null, arguments)}},scopedSlots:_vm._u([{key:\"append\",fn:function(){return [_vm._v(\" Hz \")]},proxy:true},{key:\"append-outer\",fn:function(){return [_c('v-icon',{staticClass:\"ml-1\",attrs:{\"disabled\":!_vm.canSetFrequency},on:{\"click\":_vm.setFrequency}},[_vm._v(\"mdi-check\")])]},proxy:true}]),model:{value:(_vm.frequency),callback:function ($$v) {_vm.frequency=_vm._n($$v)},expression:\"frequency\"}}),_c('v-text-field',{staticClass:\"mt-3\",attrs:{\"type\":\"number\",\"min\":\"0.01\",\"step\":\"0.01\",\"max\":\"0.99\",\"disabled\":_vm.uiFrozen,\"label\":\"Damping factor\",\"hide-details\":\"\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.preventDefault();return _vm.setDamping.apply(null, arguments)}},scopedSlots:_vm._u([{key:\"append-outer\",fn:function(){return [_c('v-icon',{staticClass:\"ml-1\",attrs:{\"disabled\":!_vm.canSetDamping},on:{\"click\":_vm.setDamping}},[_vm._v(\"mdi-check\")])]},proxy:true}]),model:{value:(_vm.damping),callback:function ($$v) {_vm.damping=_vm._n($$v)},expression:\"damping\"}})],1)],1)],1),_c('record-motion-profile-dialog',{attrs:{\"last-run\":_vm.lastRun,\"shown\":_vm.showDataCollection},on:{\"update:shown\":function($event){_vm.showDataCollection=$event},\"finished\":_vm.recordingFinished}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{ref:\"chart\",on:{\"mousedown\":_vm.mouseDown,\"mousemove\":_vm.mouseMove,\"dblclick\":_vm.doubleClick}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{staticClass:\"d-flex flex-column\",attrs:{\"flat\":\"\"}},[_c('v-card-title',{staticClass:\"pt-2 pb-1 no-wrap\"},[_c('v-icon',{staticClass:\"mr-2\"},[_vm._v(\"mdi-format-list-bulleted\")]),_vm._v(\" \"+_vm._s(_vm.title)+\" \"),_c('v-spacer'),_c('v-icon',{staticClass:\"ml-2\",attrs:{\"disabled\":_vm.uiFrozen},on:{\"click\":function($event){return _vm.$emit('refresh')}}},[_vm._v(\"mdi-refresh\")])],1),_c('v-card-text',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.files.length === 0),expression:\"files.length === 0\"}],staticClass:\"pa-0\"},[_c('v-alert',{staticClass:\"mb-0\",attrs:{\"value\":true,\"type\":\"info\"}},[_vm._v(\" No Profiles \")])],1),_c('v-progress-linear',{attrs:{\"active\":_vm.progress !== _vm.progressMax,\"value\":(_vm.progress / _vm.progressMax) * 100}}),(_vm.profiles.length > 0)?[(!_vm.individualFiles)?[_c('v-list',{staticClass:\"py-0\",attrs:{\"disabled\":_vm.uiFrozen || _vm.progress !== _vm.progressMax,\"dense\":\"\"}},[_c('v-list-item-group',{attrs:{\"color\":\"primary\"},model:{value:(_vm.selection),callback:function ($$v) {_vm.selection=$$v},expression:\"selection\"}},_vm._l((_vm.profiles),function(profile,index){return _c('v-list-item',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],key:index,attrs:{\"value\":profile.files.map(function (item) { return item.filename; }),\"two-line\":\"\"}},[_c('v-list-item-icon',{staticClass:\"align-self-center\"},[_c('v-icon',[_vm._v(\" \"+_vm._s(profile.icon)+\" \")])],1),_c('v-list-item-content',[_c('v-list-item-title',{staticClass:\"no-overflow\"},[_vm._v(\" \"+_vm._s(profile.title)+\" \")]),_c('v-list-item-subtitle',{staticClass:\"no-overflow\"},[_vm._v(\" \"+_vm._s(profile.subtitle)+\" \")])],1),(_vm.canDelete)?_c('v-list-item-icon',{staticClass:\"align-self-center\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.deleteProfile(profile)}}},[_c('v-icon',[_vm._v(\" mdi-delete \")])],1):_vm._e()],1)}),1)],1)]:[_c('v-list',{staticClass:\"py-0\",attrs:{\"disabled\":_vm.uiFrozen || _vm.progress !== _vm.progressMax,\"dense\":\"\"}},_vm._l((_vm.profiles),function(profile,index){return _c('v-list-group',{key:index,scopedSlots:_vm._u([{key:\"activator\",fn:function(){return [_c('v-list-item-icon',{staticClass:\"align-self-center\"},[_c('v-icon',[_vm._v(\" \"+_vm._s(profile.icon)+\" \")])],1),_c('v-list-item-content',[_c('v-list-item-title',{staticClass:\"no-overflow\"},[_vm._v(\" \"+_vm._s(profile.title)+\" \")]),_c('v-list-item-subtitle',{staticClass:\"no-overflow\"},[_vm._v(\" \"+_vm._s(profile.subtitle)+\" \")])],1)]},proxy:true}],null,true)},[_c('v-list-item-group',{model:{value:(_vm.selection),callback:function ($$v) {_vm.selection=$$v},expression:\"selection\"}},_vm._l((profile.files),function(file,fileIndex){return _c('v-list-item',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],key:fileIndex,attrs:{\"value\":[file.filename]}},[_c('v-list-item-icon',[_c('v-icon',[_vm._v(\"mdi-file\")])],1),_c('v-list-item-title',{staticClass:\"no-overflow\"},[_vm._v(\" \"+_vm._s(file.title)+\" \")]),(_vm.canDelete)?_c('v-list-item-icon',{on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.deleteFile(file.filename)}}},[_c('v-icon',[_vm._v(\" mdi-delete \")])],1):_vm._e()],1)}),1)],1)}),1)]]:[_c('v-alert',{staticClass:\"mb-0\",attrs:{\"type\":\"info\"}},[_vm._v(\" No Profiles found \")])],_c('v-spacer'),_c('v-checkbox',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.individualFiles && _vm.estimateEffect),expression:\"!individualFiles && estimateEffect\"}],staticClass:\"ma-3 mb-0\",attrs:{\"input-value\":_vm.showOriginalValues,\"label\":\"Show original values\",\"hide-details\":\"\"},on:{\"change\":function($event){return _vm.$emit('update:showOriginalValues', $event)}}}),_c('v-checkbox',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.individualFiles),expression:\"!individualFiles\"}],staticClass:\"ma-3 mb-0\",attrs:{\"label\":\"Estimate shaper effect\",\"hide-details\":\"\"},model:{value:(_vm.estimateEffect),callback:function ($$v) {_vm.estimateEffect=$$v},expression:\"estimateEffect\"}}),_c('div',{staticClass:\"justify-space-between ma-3 mb-0\",class:_vm.individualFiles ? 'd-flex' : 'd-none'},[_c('v-checkbox',{staticClass:\"mt-0\",attrs:{\"value\":_vm.showSamples,\"label\":\"Show samples\",\"hide-details\":\"\"},on:{\"change\":function($event){return _vm.setShowSamples($event)}}}),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showSamples),expression:\"showSamples\"}],attrs:{\"color\":\"primary\",\"small\":\"\",\"disabled\":_vm.selection.length === 0},on:{\"click\":function($event){_vm.showSamples = false}}},[_c('v-icon',{staticClass:\"mr-1\",attrs:{\"small\":\"\"}},[_vm._v(\"mdi-poll\")]),_vm._v(\" Analyze \")],1)],1),_c('v-checkbox',{staticClass:\"ma-3\",attrs:{\"label\":\"Display individual files\",\"hide-details\":\"\"},model:{value:(_vm.individualFiles),callback:function ($$v) {_vm.individualFiles=$$v},expression:\"individualFiles\"}})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-dialog',{attrs:{\"max-width\":\"640px\",\"no-click-animation\":\"\"},model:{value:(_vm.shownInternal),callback:function ($$v) {_vm.shownInternal=$$v},expression:\"shownInternal\"}},[_c('v-card',[_c('v-card-title',[_c('span',{staticClass:\"headline\"},[_vm._v(\" Record Motion Profile \")])]),_c('v-card-text',{staticClass:\"pb-0\"},[_c('v-window',{model:{value:(_vm.currentPage),callback:function ($$v) {_vm.currentPage=$$v},expression:\"currentPage\"}},[_c('v-window-item',{attrs:{\"value\":\"start\"}},[_vm._v(\" This wizard lets you to collect motion profiles using an accelerometer to tune input shaping.\"),_c('br'),_c('ul',{staticClass:\"mt-3 mb-4\"},[_c('li',[_vm._v(\"Motion Profile #\"+_vm._s(this.run))]),_c('li',[_vm._v(\"Input Shaper: \"+_vm._s(this.shaper))]),_c('li',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.frequency !== null),expression:\"frequency !== null\"}]},[_vm._v(\"Shaper Frequency: \"+_vm._s(_vm.frequency))]),_c('li',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.damping !== null),expression:\"damping !== null\"}]},[_vm._v(\"Damping Factor: \"+_vm._s(_vm.damping))]),_c('li',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.amplitudes !== null),expression:\"amplitudes !== null\"}]},[_vm._v(\"Amplitudes: \"+_vm._s(_vm.amplitudes))]),_c('li',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.durations !== null),expression:\"durations !== null\"}]},[_vm._v(\"Durations: \"+_vm._s(_vm.durations))])]),_c('v-alert',{staticClass:\"my-3\",attrs:{\"value\":_vm.accelerometers.length === 0,\"dense\":\"\",\"text\":\"\",\"type\":\"error\"}},[_vm._v(\" No accelerometer found! \"),_c('a',{staticClass:\"float-right\",attrs:{\"href\":\"https://docs.duet3d.com/User_manual/Connecting_hardware/Sensors_Accelerometer\",\"target\":\"_blank\"}},[_vm._v(\" Help \")])]),_c('v-alert',{staticClass:\"centered-alert my-3\",attrs:{\"value\":!_vm.allAxesHomed,\"border\":\"left\",\"dense\":\"\",\"text\":\"\",\"type\":\"warning\"}},[_vm._v(\" Machine is not homed \"),_c('code-btn',{staticClass:\"float-right\",attrs:{\"code\":\"G28\",\"color\":\"warning\",\"small\":\"\"}},[_vm._v(\" Home All \")])],1),_c('v-alert',{staticClass:\"my-3\",attrs:{\"value\":(_vm.accelerometers.length > 0) && _vm.allAxesHomed,\"dense\":\"\",\"text\":\"\",\"type\":\"success\"}},[_vm._v(\" Ready to record data \")]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:((_vm.accelerometers.length > 0) && _vm.allAxesHomed),expression:\"(accelerometers.length > 0) && allAxesHomed\"}]},[_vm._v(\" Press Next to continue. \")])],1),_c('v-window-item',{attrs:{\"value\":\"config\"}},[_c('div',{staticClass:\"d-flex flex-column\"},[_vm._v(\" Here you can define different moves for the data collection. \"),_c('v-simple-table',{staticClass:\"mt-1\"},[_c('thead',[_c('tr',[_c('th',{staticClass:\"px-0\"},[_vm._v(\" Tool \")]),_c('th',[_vm._v(\" Accelerometer \")]),_c('th',{staticClass:\"px-0\"},[_vm._v(\" Axis \")]),_c('th',{staticClass:\"pr-0\"},[_vm._v(\" Start Position \")]),_c('th',[_vm._v(\" End Position \")]),_c('th')])]),_c('tbody',_vm._l((_vm.moves),function(move,index){return _c('tr',{key:index},[_c('td',{staticClass:\"px-0\"},[_c('v-select',{staticClass:\"pt-0\",attrs:{\"value\":move.tool,\"items\":_vm.toolList,\"hide-details\":\"\"},on:{\"change\":function($event){return _vm.setMoveTool(move, $event)}}})],1),_c('td',[_c('v-select',{staticClass:\"pt-0\",attrs:{\"items\":_vm.accelerometers,\"rules\":[function (val) { return !!val; }],\"hide-details\":\"\"},model:{value:(move.accelerometer),callback:function ($$v) {_vm.$set(move, \"accelerometer\", $$v)},expression:\"move.accelerometer\"}})],1),_c('td',{staticClass:\"px-0\"},[_c('v-select',{staticClass:\"pt-0\",attrs:{\"value\":move.axis,\"items\":['X', 'Y', 'X+Y'],\"hide-details\":\"\"},on:{\"change\":function($event){return _vm.setMoveAxis(move, $event)}}})],1),_c('td',{staticClass:\"pr-0\"},[_c('v-text-field',{staticClass:\"pt-0\",attrs:{\"type\":\"number\",\"min\":_vm.getMin(move, true),\"max\":_vm.getMax(move, true),\"rules\":_vm.getRules(move, true),\"hide-details\":\"\"},model:{value:(move.start),callback:function ($$v) {_vm.$set(move, \"start\", _vm._n($$v))},expression:\"move.start\"}})],1),_c('td',[_c('v-text-field',{staticClass:\"pt-0\",attrs:{\"type\":\"number\",\"min\":_vm.getMin(move, false),\"max\":_vm.getMax(move, false),\"rules\":_vm.getRules(move, false),\"hide-details\":\"\"},model:{value:(move.end),callback:function ($$v) {_vm.$set(move, \"end\", _vm._n($$v))},expression:\"move.end\"}})],1),_c('td',{staticClass:\"px-0\"},[_c('v-btn',{attrs:{\"color\":\"warning\",\"outlined\":\"\",\"disabled\":_vm.moves.length <= 1},on:{\"click\":function($event){return _vm.removeMove(index)}}},[_c('v-icon',[_vm._v(\"mdi-delete\")])],1)],1)])}),0)]),_c('v-divider',{staticClass:\"mb-3\"}),_c('v-btn',{staticClass:\"mx-auto\",attrs:{\"color\":\"blue darken-1\",\"outlined\":\"\",\"text\":\"\"},on:{\"click\":_vm.addMove}},[_c('v-icon',{staticClass:\"mr-1\"},[_vm._v(\"mdi-plus\")]),_vm._v(\" Add Move \")],1),_c('v-alert',{staticClass:\"mt-3\",attrs:{\"value\":_vm.hasExternalAccelerometers,\"type\":\"info\",\"dense\":\"\"}},[_vm._v(\" This machine appears to have expansion boards with embedded accelerometers. If you are operating a tool changer, it is recommended to set the corresponding tool for each accelerometer. \")]),_c('v-checkbox',{staticClass:\"my-2\",attrs:{\"label\":\"Centre unused axes before each move\",\"ripple\":false,\"hide-details\":\"\"},model:{value:(_vm.centerAxes),callback:function ($$v) {_vm.centerAxes=$$v},expression:\"centerAxes\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.centerAxes),expression:\"centerAxes\"}],staticClass:\"mx-9\"},[_c('div',{staticClass:\"d-inline-flex\"},[_c('v-text-field',{attrs:{\"type\":\"number\",\"label\":\"X axis centre position\",\"min\":_vm.xAxis.min,\"max\":_vm.xAxis.max,\"step\":\"1\",\"rules\":[function (val) { return !isNaN(val) && val >= _vm.xAxis.min && val <= _vm.xAxis.max; }]},model:{value:(_vm.xAxisCenter),callback:function ($$v) {_vm.xAxisCenter=_vm._n($$v)},expression:\"xAxisCenter\"}}),_c('v-text-field',{staticClass:\"ml-5\",attrs:{\"type\":\"number\",\"label\":\"Y axis centre position\",\"min\":_vm.xAxis.min,\"max\":_vm.xAxis.max,\"step\":\"1\",\"rules\":[function (val) { return !isNaN(val) && val >= _vm.yAxis.min && val <= _vm.yAxis.max; }]},model:{value:(_vm.yAxisCenter),callback:function ($$v) {_vm.yAxisCenter=_vm._n($$v)},expression:\"yAxisCenter\"}}),_c('v-text-field',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showZCenter),expression:\"showZCenter\"}],staticClass:\"ml-5\",attrs:{\"type\":\"number\",\"label\":\"Z axis centre position\",\"rules\":[function (val) { return !isNaN(val) && val >= _vm.zAxis.min && val <= _vm.zAxis.max; }]},model:{value:(_vm.zAxisCenter),callback:function ($$v) {_vm.zAxisCenter=_vm._n($$v)},expression:\"zAxisCenter\"}})],1)]),_c('v-checkbox',{staticClass:\"my-2\",attrs:{\"label\":\"Capture data during the whole length of the move\",\"ripple\":false,\"hide-details\":\"\"},model:{value:(_vm.recordWholeMove),callback:function ($$v) {_vm.recordWholeMove=$$v},expression:\"recordWholeMove\"}}),_vm._v(\" The machine will record a new Motion Profile as soon as Next is clicked. \")],1)]),_c('v-window-item',{attrs:{\"value\":\"collection\"}},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.finished),expression:\"!finished\"}]},[_vm._v(\" Please stand by while Motion Profiles are being recorded... \")]),_c('v-simple-table',{staticClass:\"mt-1\"},[_c('thead',[_c('tr',[_c('th',{staticClass:\"px-0\"}),_c('th',[_vm._v(\" Tool \")]),_c('th',{staticClass:\"px-0\"},[_vm._v(\" Accelerometer \")]),_c('th',[_vm._v(\" Axis \")]),_c('th',{staticClass:\"px-0\"},[_vm._v(\" Start Position \")]),_c('th',[_vm._v(\" End Position \")])])]),_c('tbody',_vm._l((_vm.moves),function(move,index){return _c('tr',{key:index},[_c('td',{staticClass:\"px-0\"},[_c('v-icon',[_vm._v(\" \"+_vm._s(_vm.getMoveIcon(move))+\" \")])],1),_c('td',[_vm._v(\" \"+_vm._s(move.tool ? (move.tool.name || (\"T\" + (move.tool.number))) : 'None')+\" \")]),_c('td',{staticClass:\"px-0\"},[_vm._v(\" \"+_vm._s(_vm.getAccelerometerId(move.accelerometer))+\" \")]),_c('td',[_vm._v(\" \"+_vm._s(move.axis)+\" \")]),_c('td',{staticClass:\"px-0\"},[_vm._v(\" \"+_vm._s(move.start)+\" \")]),_c('td',[_vm._v(\" \"+_vm._s(move.end)+\" \")])])}),0)]),_c('v-divider'),_c('v-alert',{staticClass:\"mt-3\",attrs:{\"value\":_vm.cancelled,\"dense\":\"\",\"text\":\"\",\"type\":\"error\"}},[_vm._v(\" Data collection cancelled! \")]),_c('v-alert',{staticClass:\"mt-3\",attrs:{\"value\":_vm.finished,\"dense\":\"\",\"text\":\"\",\"type\":\"success\"}},[_vm._v(\" Recording of Motion Profile #\"+_vm._s(this.run)+\" is complete! \")])],1)],1)],1),_c('v-card-actions',[_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.cancelled && !_vm.finished),expression:\"!cancelled && !finished\"}],attrs:{\"color\":\"blue darken-1\",\"text\":\"\"},on:{\"click\":_vm.cancel}},[_vm._v(\" Cancel \")]),_c('v-spacer'),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.canGoBack),expression:\"canGoBack\"}],attrs:{\"color\":\"blue darken-1\",\"text\":\"\"},on:{\"click\":_vm.goBack}},[_vm._v(\" Back \")]),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.currentPage !== 'collection'),expression:\"currentPage !== 'collection'\"}],attrs:{\"color\":\"blue darken-1\",\"text\":\"\",\"disabled\":!_vm.canGoNext},on:{\"click\":_vm.goNext}},[_vm._v(\" Next \")]),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.cancelled || _vm.finished),expression:\"cancelled || finished\"}],attrs:{\"color\":\"blue darken-1\",\"text\":\"\"},on:{\"click\":function($event){_vm.shownInternal = false}}},[_vm._v(\" Finish \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./InputShaperCheckbox.vue?vue&type=template&id=b04a29ea&\"\nimport script from \"./InputShaperCheckbox.vue?vue&type=script&lang=js&\"\nexport * from \"./InputShaperCheckbox.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCheckbox } from 'vuetify/lib/components/VCheckbox';\nimport { VChip } from 'vuetify/lib/components/VChip';\ninstallComponents(component, {VCheckbox,VChip})\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShaperCheckbox.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShaperCheckbox.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"6eedfb67-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShaperCheckbox.vue?vue&type=template&id=b04a29ea&\"","import { render, staticRenderFns } from \"./InputShaping.vue?vue&type=template&id=279e43a3&scoped=true&\"\nimport script from \"./InputShaping.vue?vue&type=script&lang=js&\"\nexport * from \"./InputShaping.vue?vue&type=script&lang=js&\"\nimport style0 from \"./InputShaping.vue?vue&type=style&index=0&id=279e43a3&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"279e43a3\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTab } from 'vuetify/lib/components/VTabs';\nimport { VTabItem } from 'vuetify/lib/components/VTabs';\nimport { VTabs } from 'vuetify/lib/components/VTabs';\nimport { VTabsItems } from 'vuetify/lib/components/VTabs';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardText,VCardTitle,VCol,VDivider,VIcon,VProgressLinear,VRow,VTab,VTabItem,VTabs,VTabsItems,VTextField})\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShaping.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShaping.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShaping.vue?vue&type=style&index=0&id=279e43a3&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"6eedfb67-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShaping.vue?vue&type=template&id=279e43a3&scoped=true&\"","import { render, staticRenderFns } from \"./InputShapingChart.vue?vue&type=template&id=7e126ffc&\"\nimport script from \"./InputShapingChart.vue?vue&type=script&lang=js&\"\nexport * from \"./InputShapingChart.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShapingChart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShapingChart.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"6eedfb67-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShapingChart.vue?vue&type=template&id=7e126ffc&\"","import { render, staticRenderFns } from \"./InputShapingFileList.vue?vue&type=template&id=df8f86dc&scoped=true&\"\nimport script from \"./InputShapingFileList.vue?vue&type=script&lang=js&\"\nexport * from \"./InputShapingFileList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./InputShapingFileList.vue?vue&type=style&index=0&id=df8f86dc&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"df8f86dc\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCheckbox } from 'vuetify/lib/components/VCheckbox';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VList } from 'vuetify/lib/components/VList';\nimport { VListGroup } from 'vuetify/lib/components/VList';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemGroup } from 'vuetify/lib/components/VList';\nimport { VListItemIcon } from 'vuetify/lib/components/VList';\nimport { VListItemSubtitle } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardText,VCardTitle,VCheckbox,VIcon,VList,VListGroup,VListItem,VListItemContent,VListItemGroup,VListItemIcon,VListItemSubtitle,VListItemTitle,VProgressLinear,VSpacer})\n\n\n/* vuetify-loader */\nimport installDirectives from \"!../../../node_modules/vuetify-loader/lib/runtime/installDirectives.js\"\nimport Ripple from 'vuetify/lib/directives/ripple'\ninstallDirectives(component, {Ripple})\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShapingFileList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShapingFileList.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShapingFileList.vue?vue&type=style&index=0&id=df8f86dc&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"6eedfb67-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputShapingFileList.vue?vue&type=template&id=df8f86dc&scoped=true&\"","// based on the VerticalLinePlugin\r\n'use strict'\r\n\r\nimport Chart from 'chart.js'\r\n\r\nconst verticalLinePlugin = {\r\n\trenderRect(chartInstance, startX, endX) {\r\n\t\tconst scale = chartInstance.scales['y-axis-0'];\r\n\t\tconst context = chartInstance.chart.ctx;\r\n\r\n\t\t// render vertical line\r\n\t\tcontext.beginPath();\r\n\t\tcontext.rect(startX, scale.top, endX - startX, scale.bottom - scale.top);\r\n\t\tcontext.fillStyle = (chartInstance.options.plugins.range && chartInstance.options.plugins.range.color) || '#0000FF30';\r\n\t\tcontext.fill();\r\n\t},\r\n\tbeforeDatasetsDraw(chart) {\r\n\t\tif (chart.config.range) {\r\n\t\t\tthis.renderRect(chart, Math.min(chart.config.range.start, chart.config.range.end), Math.max(chart.config.range.start, chart.config.range.end));\r\n\t\t}\r\n\t}\r\n};\r\n\r\nChart.plugins.register(verticalLinePlugin);","import { render, staticRenderFns } from \"./RecordMotionProfileDialog.vue?vue&type=template&id=648d3f54&\"\nimport script from \"./RecordMotionProfileDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./RecordMotionProfileDialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RecordMotionProfileDialog.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCheckbox } from 'vuetify/lib/components/VCheckbox';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSimpleTable } from 'vuetify/lib/components/VDataTable';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VWindow } from 'vuetify/lib/components/VWindow';\nimport { VWindowItem } from 'vuetify/lib/components/VWindow';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardActions,VCardText,VCardTitle,VCheckbox,VDialog,VDivider,VIcon,VSelect,VSimpleTable,VSpacer,VTextField,VWindow,VWindowItem})\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RecordMotionProfileDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RecordMotionProfileDialog.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RecordMotionProfileDialog.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"6eedfb67-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RecordMotionProfileDialog.vue?vue&type=template&id=648d3f54&\"","// Original code from https://stackoverflow.com/questions/30256695/chart-js-drawing-an-arbitrary-vertical-line\r\n'use strict'\r\n\r\nimport Chart from 'chart.js'\r\n\r\nconst VLinePlugin = {\r\n\tid: 'vline',\r\n    getLinePosition(chart, pointIndex) {\r\n\t\tif (chart.data.datasets.length === 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n        const meta = chart.getDatasetMeta(0); // first dataset is used to discover X coordinate of a point\r\n        const data = meta.data;\r\n        return data ? data[pointIndex]._model.x : null;\r\n    },\r\n    renderVerticalLine(chartInstance, pointIndex) {\r\n        const lineLeftOffset = this.getLinePosition(chartInstance, pointIndex);\r\n\t\tif (lineLeftOffset === null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n        const scale = chartInstance.scales['y-axis-0'];\r\n        const context = chartInstance.chart.ctx;\r\n\r\n        // render vertical line\r\n        context.beginPath();\r\n\t\tcontext.lineWidth = (chartInstance.options.plugins.vline && chartInstance.options.plugins.vline.lineWidth) || 1;\r\n        context.strokeStyle = (chartInstance.options.plugins.vline && chartInstance.options.plugins.vline.lineColor) || '#ff0000';\r\n        context.moveTo(lineLeftOffset, scale.top);\r\n        context.lineTo(lineLeftOffset, scale.bottom);\r\n        context.stroke();\r\n    },\r\n    beforeDatasetsDraw(chart) {\r\n        if (chart.config.lineAtIndex) {\r\n            chart.config.lineAtIndex.forEach(pointIndex => this.renderVerticalLine(chart, pointIndex));\r\n        }\r\n    }\r\n};\r\n\r\nChart.plugins.register(VLinePlugin);","'use strict'\r\n\r\nimport { registerRoute } from '@/routes'\r\n\r\nimport InputShaping from './InputShaping.vue'\r\n\r\n// Register a route via Plugins -> Input Shaping\r\nregisterRoute(InputShaping, {\r\n\tPlugins: {\r\n\t\tInputShaping: {\r\n\t\t\ticon: 'mdi-transition',\r\n\t\t\tcaption: 'Input Shaping',\r\n\t\t\ttranslated: true,\r\n\t\t\tpath: '/InputShaping'\r\n\t\t}\r\n\t}\r\n});\r\n","'use strict'\r\n\r\nclass CSV {\r\n\theaders = []\r\n\tcontent = []\r\n\r\n\tconstructor(content) {\r\n\t\tlet row = 0, col = 0, inQuote = false;\r\n\t\tfor (let i = 0; i < content.length; i++) {\r\n\t\t\tconst char = content[i], nextChar = content[i + 1];\r\n\r\n\t\t\t// Make sure we have enough rows+cols\r\n\t\t\tif (row === 0) {\r\n\t\t\t\tif (this.headers.length <= col) {\r\n\t\t\t\t\tthis.headers.push('');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.content.length < row) {\r\n\t\t\t\t\tthis.content.push([]);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.content[row - 1].length <= col) {\r\n\t\t\t\t\tthis.content[row - 1].push('');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Deal with escaped quotes\r\n\t\t\tif (inQuote && char === '\"' && nextChar === '\"') {\r\n\t\t\t\tif (row === 0) {\r\n\t\t\t\t\tthis.headers[col] += char;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.content[row - 1][col] += char;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// Deal with the start or end of a field\r\n\t\t\tif (char === '\"') {\r\n\t\t\t\tinQuote = !inQuote;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// Check if we can move on to the next field\r\n\t\t\tif (char === ',' && !inQuote) {\r\n\t\t\t\tcol++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// Check if we can move on to the next row\r\n\t\t\tif (char === '\\n' && !inQuote) {\r\n\t\t\t\tthis.content.push([]);\r\n\t\t\t\tcol = 0;\r\n\t\t\t\t++row;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise append the current character\r\n\t\t\tif (row === 0) {\r\n\t\t\t\tthis.headers[col] += char;\r\n\t\t\t} else {\r\n\t\t\t\tthis.content[row - 1][col] += char;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.content.length > 0 && this.content[this.content.length - 1].length === 0) {\r\n\t\t\t// Remove last content row if it is empty\r\n\t\t\tthis.content.splice(-1, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tget(fieldName, row = 0) {\r\n\t\tconst index = this.headers.findIndex(header => header === fieldName);\r\n\t\tif (index === -1) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn this.content[row][index];\r\n\t}\r\n}\r\n\r\nexport default CSV\r\n"],"sourceRoot":""}